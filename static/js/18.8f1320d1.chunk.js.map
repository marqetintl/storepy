{"version":3,"sources":["../../../../packages/miq-adminjs/src/settings/GeneralSettingsUpdateView.jsx"],"names":["GeneralSettingsUpdateView","props","toast","useContext","ToastCtx","ctx","SharedDataCtx","useState","setting","setSetting","site","form","useForm","name","domain","contact_number","contact_number_display","contact_number_title","contact_email","whatsapp_link","whatsapp_link_title","ga_tracking","fb_pixel","settingSlug","settings","siteName","siteDomain","setValues","useEffect","siteServices","detail","then","data","slug","catch","err","title","back","className","context","onSubmit","e","preventDefault","patchSite","values","isUpdated","updateSite","success","message","handleError","Section","Label","value","TextInput","required","error","errors","disabled","Boolean","Submit","logo_data","onCreate","imgData","patch","logo","onUpdate","oldValues","Object","keys","forEach","key","text","type","placeholder","minLength","maxLength","Field","label"],"mappings":"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","file":"static/js/18.8f1320d1.chunk.js","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\n\nimport { SharedDataCtx } from '@miq/contexts';\nimport Form, { useForm } from '@miq/form/';\nimport { ImgUploadButton, Img, ToastCtx } from '@miq/components';\n\nimport { AdminView } from '../views';\nimport { siteServices } from './utils';\nimport SiteLiveSettingForm from './GeneralLiveSettingsUpdateSection';\n\nexport default function GeneralSettingsUpdateView(props) {\n  const toast = useContext(ToastCtx);\n  const ctx = useContext(SharedDataCtx);\n  const [setting, setSetting] = useState({});\n\n  const { site = {} } = ctx;\n\n  const form = useForm({\n    name: site.name,\n    domain: site.domain,\n    contact_number: setting.contact_number || '',\n    contact_number_display: setting.contact_number_display || '',\n    contact_number_title: setting.contact_number_title || '',\n    contact_email: setting.contact_email || '',\n    whatsapp_link: setting.whatsapp_link || '',\n    whatsapp_link_title: setting.whatsapp_link_title || '',\n    ga_tracking: setting.ga_tracking || '',\n    fb_pixel: setting.fb_pixel || '',\n  });\n\n  const settingSlug = site.settings;\n  const siteName = site?.name;\n  const siteDomain = site?.domain;\n  const setValues = form.setValues;\n\n  useEffect(() => {\n    siteServices\n      .detail(settingSlug)\n      .then((data) => {\n        if (!data.slug) return;\n        setSetting(data);\n        setValues({\n          name: siteName || '',\n          domain: siteDomain || '',\n          contact_number: data.contact_number || '',\n          contact_number_title: data.contact_number_title || '',\n          contact_number_display: data.contact_number_display || '',\n          contact_email: data.contact_email || '',\n          whatsapp_link: data.whatsapp_link || '',\n          whatsapp_link_title: data.whatsapp_link_title || '',\n          ga_tracking: data.ga_tracking || '',\n          fb_pixel: data.fb_pixel || '',\n        });\n      })\n      .catch((err) => {});\n  }, [settingSlug, setValues, siteName, siteDomain]);\n\n  if (!setting.slug) return null;\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    return siteServices\n      .patchSite(\n        settingSlug,\n        { name: form.values.name, domain: form.values.domain },\n        { name: site.name, domain: site.domain }\n      )\n      .then(({ isUpdated, ...data }) => {\n        if (isUpdated) {\n          ctx.updateSite(data.site);\n          toast.success({ message: 'Site updated.' });\n        }\n      })\n      .catch((err) => form.handleError(err));\n  };\n\n  return (\n    <AdminView title=\"Site General Settings\" back={props?.back}>\n      <div className=\"d-grid grid-md-4 gap-2\">\n        <Form context={form} onSubmit={handleSubmit} className=\"span-md-3\">\n          <AdminView.Section title=\"Site Details\">\n            <div className=\"mb-1\">\n              <Form.Label value=\"Site name\" />\n              <Form.TextInput required name=\"name\" error={form.errors.name} disabled={!Boolean(site.settings)} />\n            </div>\n\n            <div className=\"mb-1\">\n              <Form.Label value=\"Site domain\" />\n              <Form.TextInput required name=\"domain\" error={form.errors.domain} disabled={!Boolean(site.settings)} />\n            </div>\n\n            <div className=\"\">\n              <Form.Submit value=\"Save\" className=\"btn btn-primary-2\" />\n            </div>\n          </AdminView.Section>\n        </Form>\n\n        <AdminView.Section title=\"Site logo\" className=\"span-md-1\">\n          <ImgUploadButton\n            slug={setting && setting.logo_data ? setting.logo_data.slug : null}\n            onCreate={(imgData) =>\n              siteServices\n                .patch(setting.slug, { logo: imgData.slug })\n                .then((data) => {\n                  setSetting(data);\n                  toast.success({ message: 'Logo added.' });\n                })\n                .catch((err) => {})\n            }\n            onUpdate={(imgData) => {\n              setSetting({ ...setting, logo_data: imgData });\n              toast.success({ message: 'Logo updated.' });\n            }}\n            className=\"site-logo-upload-button\"\n          >\n            <Img {...setting.logo_data} className=\"site-logo\" />\n          </ImgUploadButton>\n        </AdminView.Section>\n      </div>\n\n      <SiteLiveSettingForm {...{ ctx, setting, setSetting, toast }} />\n\n      <Form\n        context={form}\n        onSubmit={(e) => {\n          e.preventDefault();\n\n          const oldValues = {};\n          Object.keys(form.values).forEach((key) => {\n            oldValues[key] = setting[key];\n          });\n\n          return siteServices\n            .patch(setting.slug, form.values, oldValues)\n            .then(({ isUpdated, ...data }) => {\n              if (isUpdated) {\n                setSetting && setSetting(data);\n                toast && toast.success({ message: 'Site updated.' });\n              }\n            })\n            .catch((err) => form.handleError(err));\n        }}\n        className=\"d-grid grid-md-2 gap-2\"\n      >\n        <AdminView.Section\n          title=\"Contact\"\n          text=\"What's the best way to contact you?\"\n          // className=\"span-md-1\"\n        >\n          <div className=\"mb-1\">\n            <Form.Label value=\"Phone number\" />\n            <Form.TextInput\n              name=\"contact_number\"\n              type=\"tel\"\n              error={form.errors.contact_number}\n              // pattern=\"[0-9]{3}-[0-9]{3}-[0-9]{4}\"\n              placeholder=\"Write your contact number with country extension ... ex(+1...)\"\n              minLength={8}\n              maxLength={16}\n            />\n          </div>\n          <div className=\"mb-1\">\n            <Form.Label value=\"Phone number display\" />\n            <Form.TextInput\n              name=\"contact_number_display\"\n              error={form.errors.contact_number_display}\n              placeholder=\"Write your contact number without country extension ...\"\n              maxLength={99}\n            />\n          </div>\n\n          <div className=\"mb-2\">\n            <Form.Label value=\"Phone number link text\" />\n            <Form.TextInput\n              name=\"contact_number_title\"\n              error={form.errors.contact_number_title}\n              placeholder=\"Describe your phone number link ...\"\n              maxLength={99}\n            />\n          </div>\n\n          <div className=\"\">\n            <Form.Label value=\"Email\" />\n            <Form.TextInput\n              name=\"contact_email\"\n              type=\"email\"\n              error={form.errors.contact_email}\n              placeholder=\"Write your contact email ...\"\n              maxLength={99}\n            />\n          </div>\n        </AdminView.Section>\n\n        <AdminView.Section title=\"Whatsapp\" text=\"A whatsapp icon will be added to your site.\">\n          <div className=\"mb-1\">\n            <Form.Label value=\"Whatsapp link\" />\n            <Form.TextInput\n              name=\"whatsapp_link\"\n              type=\"url\"\n              error={form.errors.whatsapp_link}\n              placeholder=\"Write your whatsapp link ...\"\n              maxLength={200}\n            />\n          </div>\n          <div className=\"\">\n            <Form.Label value=\"Whatsapp link text\" />\n            <Form.TextInput\n              name=\"whatsapp_link_title\"\n              error={form.errors.whatsapp_link_title}\n              placeholder=\"Describe your whatsapp link ...\"\n              maxLength={99}\n            />\n          </div>\n        </AdminView.Section>\n\n        <AdminView.Section title=\"Analytics\" text=\"Set up third-party analytics.\" className=\"\">\n          <Form.Field label=\"Google Analytics Tracking Number\">\n            <Form.TextInput name=\"ga_tracking\" error={form.errors.ga_tracking} />\n          </Form.Field>\n\n          <Form.Field label=\"Facebook Pixel\">\n            <Form.TextInput name=\"fb_pixel\" error={form.errors.fb_pixel} />\n          </Form.Field>\n\n          <div className=\"\">\n            <Form.Submit value=\"Save\" className=\"btn btn-primary-2\" />\n          </div>\n        </AdminView.Section>\n\n        <AdminView.Section title=\"Social\" text=\"Display Your social media accounts.\" className=\"span-md-1\" />\n      </Form>\n    </AdminView>\n  );\n}\n"],"sourceRoot":""}