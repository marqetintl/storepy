{"version":3,"sources":["shop/public/components.jsx","shop/public/ProductsView.jsx","shop/public/ProductPreSaleForm.jsx","shop/public/ProductView.jsx"],"names":["ProductPriceDisplay","product","retail_price","sale_price","is_on_sale","className","amountWithSymbol","ProductAttributeList","attributes","map","attr","name","value","CategoryLinks","props","ctx","useContext","SharedDataCtx","isLoaded","categories","cat","href","url","title","showCover","cover","src_mobile","thumb_sq","name_truncated","slug","SearchForm","search","location","push","useRef","debounce","history","query","URLSearchParams","action","required","initialValue","get","onChange","e","target","length","delete","set","current","path","URL","window","pathname","placeholder","minLength","maxLength","BreadCrumbs","breadcrumbs","role","item","label","ProductsGrid","items","showName","ProductsPublicView","object_list","pagination","page_label","q","match","Links","cartService","Service","ERROR_MSG","stripNonDigits","replace","LeadFormFragment","form","Label","TextInput","error","errors","type","values","number","pattern","setValue","onKeyPress","test","key","preventDefault","email","ig_handle","sizes","ProductSizeRadio","size","checked","getClassName","onClick","setErrors","ProductPreSaleForm","cart","lead_id","cartItem","find","i","cartItemSlug","item_slug","useForm","is_pre_sale","InfoCircle","context","method","onSubmit","patch","catch","err","handleError","then","data","reload","post","ProductPublicView","similar","useEffect","is_pre_sale_text","description","id","images","mobileOnly","style","position","top","has_attributes","ProductPreSaleDate","is_pre_sale_dt","formatDate","day","month","year"],"mappings":"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","file":"static/js/13.30dee279.chunk.js","sourcesContent":["import ReactDOM from 'react-dom';\nimport { useContext, useEffect, useRef, useState } from 'react';\n\nimport { SharedDataCtx } from '@miq/contexts';\nimport { Img, Picture, SearchTextInput } from '@miq/components';\nimport { IS_DEV } from '@miq/utils';\nimport debounce from 'lodash.debounce';\n\n/**\n * PRODUCT\n */\n\nexport const ProductPriceDisplay = ({ product }) => {\n  if (!product || !product.retail_price) return null;\n\n  const { retail_price, sale_price } = product;\n\n  if (product.is_on_sale && sale_price != null) {\n    return (\n      <div className=\"product-price-display d-flex align-items-center\">\n        <div className=\"text-danger fw-bold me-2\">{sale_price.amountWithSymbol}</div>\n        <div className=\"text-line-through\">{retail_price.amountWithSymbol}</div>\n      </div>\n    );\n  }\n  return (\n    <div className=\"product-price-display d-flex align-items-center\">\n      <div className=\"fw-bold\">{retail_price.amountWithSymbol}</div>\n    </div>\n  );\n};\n\nexport const ProductAttributeList = ({ product }) => {\n  const { attributes = [] } = product || {};\n\n  if (!attributes) return null;\n\n  return (\n    <ul className=\"product-attr-list\">\n      {attributes?.map((attr) => {\n        return (\n          <li className=\"attr\" key={attr.name}>\n            <span className=\"attr-label\">{attr.name} : </span>\n            <span className=\"attr-value\">{attr.value}</span>\n          </li>\n        );\n      })}\n    </ul>\n  );\n};\n\n/**\n * CATEGORY\n */\n\nexport const CategoryLinks = (props) => {\n  const ctx = useContext(SharedDataCtx);\n\n  if (!ctx.isLoaded || !ctx.categories) return null;\n\n  // console.log(ctx.categories);\n\n  return (\n    <div className=\"category-links pb-2\">\n      {ctx.categories?.map((cat) => {\n        return (\n          <div className=\"item w-25 w-md-15\" key={cat.slug}>\n            <a href={cat.url} className=\"\" title={cat.name}>\n              {props.showCover && cat?.cover && (\n                <Picture {...cat.cover} src_mobile={cat?.cover?.thumb_sq || cat?.cover?.src_mobile} />\n              )}\n              <div className=\"info\">{cat.name_truncated}</div>\n            </a>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport function SearchForm(props) {\n  const { search } = props.location;\n\n  const push = useRef(debounce((url) => props?.history?.push(url), 300));\n\n  const query = new URLSearchParams(search);\n  const handleSearch = ({ e }) => {\n    const { value } = e.target;\n\n    if (!value || value.length < 3) {\n      query.delete('q');\n    } else {\n      query.set('q', e.target.value);\n    }\n\n    if (!push.current) return;\n\n    const path = new URL(window.location.href);\n    push.current(`${path.pathname}?${query}`);\n  };\n\n  return (\n    <form action=\"/shop/\" className=\"product-search-form\">\n      <SearchTextInput\n        required\n        initialValue={query.get('q')}\n        onChange={handleSearch}\n        className=\"search-input\"\n        placeholder={'Cherchez un produit ...'}\n        minLength={3}\n        maxLength={99}\n      />\n    </form>\n  );\n}\n\nexport const BreadCrumbs = (props) => {\n  const { isLoaded, breadcrumbs } = useContext(SharedDataCtx);\n\n  if (!isLoaded || !breadcrumbs) {\n    return null;\n  }\n\n  return (\n    <section className=\"miq-breadcrumbs\" role={'navigation'} aria-label=\"breadcrumbs\">\n      {breadcrumbs.map((item) => {\n        return (\n          <a href={item.path} className=\"item\" key={item.label} title={item.title} aria-label={item.title}>\n            {item.label}\n          </a>\n        );\n      })}\n    </section>\n  );\n};\n\n//\n// NOT USED\nexport const ProductDetailImages = ({ product, ...props }) => {\n  const { images = [], cover } = product;\n  const [active, setActive] = useState(cover);\n\n  const [root, setRoot] = useState(null);\n\n  useEffect(() => {\n    if (IS_DEV) return;\n\n    const el = document.getElementById('product-detail-images');\n    if (el) setRoot(el);\n  }, [setRoot]);\n\n  if (!product) return null;\n\n  const render = (\n    <div className=\"product-images d-flex flex-column-reverse flex-sm-row\">\n      <div className=\"thumbnails d-flex flex-row flex-sm-column me-1\">\n        <Img src={cover.thumb} className=\"mb-1\" onClick={() => setActive(cover)} />\n\n        {images.map((img) => (\n          <Img src={img.thumb} onClick={() => setActive(img)} className=\"mb-1\" key={img.src} />\n        ))}\n      </div>\n\n      <div className=\"\">\n        <Img src={active.src} />\n      </div>\n    </div>\n  );\n\n  return IS_DEV ? render : root ? ReactDOM.createPortal(render, root) : null;\n};\n","import React, { useContext } from 'react';\nimport { SharedDataCtx } from '@miq/contexts';\nimport { Picture, Pagination } from '@miq/components';\nimport { CategoryLinks, ProductPriceDisplay, SearchForm, BreadCrumbs } from './components';\n\nexport const ProductsGrid = ({ items, ...props }) => {\n  const { showName } = props;\n  return (\n    <div className=\"products-grid d-grid grid-2 grid-md-3 grid-lg-4 gap-2\">\n      {items?.map((product = {}) => {\n        const { cover, name } = product || {};\n\n        const url = product.url;\n        const slug = product.slug;\n\n        return (\n          <a href={`${url}`} key={slug}>\n            <div className=\"\">\n              <Picture {...cover} />\n\n              <div className=\"product-grid-info\">\n                {showName && <div className=\"product-grid-name\">{name}</div>}\n                <ProductPriceDisplay product={product} />\n              </div>\n            </div>\n          </a>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default function ProductsPublicView(props) {\n  const ctx = useContext(SharedDataCtx);\n\n  if (!ctx.isLoaded) {\n    return null;\n  }\n\n  const { object_list, pagination, page_label } = ctx;\n  const query = new URLSearchParams(props.location.search);\n  const q = query.get('q');\n\n  return (\n    <div className=\"products-view p-1 p-md-3\">\n      <header>\n        <div className=\"miq-container center\">\n          <div className=\"mb-3\">\n            <SearchForm history={props.history} match={props.match} location={props.location} />\n          </div>\n        </div>\n\n        <div className=\"mb-2\">\n          <BreadCrumbs />\n        </div>\n\n        {!q && <CategoryLinks showCover />}\n\n        {page_label && (\n          <section className=\"my-2\">\n            <h1 aria-label={page_label}>{page_label}</h1>\n          </section>\n        )}\n      </header>\n\n      <div className=\"my-3\">\n        <ProductsGrid items={object_list} showName match={props.match} />\n      </div>\n\n      <div className=\"miq-container center d-flex\">\n        <div className=\"mx-auto\">\n          <Pagination.Links pagination={pagination} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport Form, { useForm } from '@miq/form';\n\nimport { Button, Icons } from '@miq/components/';\nimport { getClassName, Service } from '@miq/utils';\n\nconst cartService = new Service('/shop/cart/');\n\nconst ERROR_MSG = {\n  name_length: 'Veuillez entrer votre nom et prénom.',\n  number_length: 'Nous ne pouvons pas vous contacter sans votre numéro.',\n  size_empty: 'Sélectionez votre taille.',\n};\nconst stripNonDigits = (value) => {\n  return value.replace(/\\D/, '');\n};\n\nconst LeadFormFragment = ({ form, ...props }) => {\n  if (!form) return null;\n\n  return (\n    <>\n      <div className=\"mb-1\">\n        <Form.Label value=\"Nom et prénom\" />\n        <Form.TextInput required name=\"name\" error={form.errors.name} maxLength={99} minLength={4} />\n      </div>\n      <div className=\"mb-1\">\n        <Form.Label value=\"Numéro de téléphone/whatsapp\" />\n        <Form.TextInput\n          required\n          name=\"number\"\n          type=\"tel\"\n          value={form.values.number}\n          pattern=\"[0-9]*\"\n          onChange={(e) => form.setValue('number', stripNonDigits(e.target.value))}\n          onKeyPress={(e) => !/[0-9]/.test(e.key) && e.preventDefault()}\n          error={form.errors.number}\n          minLength={7}\n          maxLength={16}\n        />\n      </div>\n      <div className=\"mb-1\">\n        <Form.Label value=\"Adresse email (facultatif)\" />\n        <Form.TextInput name=\"email\" type=\"email\" error={form.errors.email} minLength={4} />\n      </div>\n      <div className=\"mb-2\">\n        <Form.Label value=\"Instagram (facultatif)\" />\n        <Form.TextInput name=\"ig_handle\" minLength={3} error={form.errors.ig_handle} />\n      </div>\n    </>\n  );\n};\n\nconst sizes = [\n  { label: 'XS', value: 'XS', title: 'Extra Small' },\n  { label: 'S', value: 'S', title: 'Small' },\n  { label: 'M', value: 'M', title: 'Medium' },\n  { label: 'L', value: 'L', title: 'Large' },\n  { label: 'XL', value: 'XL', title: 'Extra Large' },\n];\n\nconst ProductSizeRadio = (props) => {\n  if (!props.form) return null;\n\n  const { form } = props;\n  const error = form.errors.size;\n\n  return (\n    <>\n      <div className=\"mb-2\">Sélectionez votre taille.</div>\n      <div className=\"product-size-radio-input\">\n        {sizes.map((size) => {\n          const checked = form.values.size === size.value;\n\n          return (\n            <div\n              className={getClassName(['radio', checked && 'checked'])}\n              onClick={() => {\n                if (form.errors.size) form.setErrors({ ...form.errors, size: null });\n                form.setValue('size', size.value);\n              }}\n              role=\"radio\"\n              key={size.label}\n            >\n              {size.label}\n            </div>\n          );\n        })}\n      </div>\n      {error && <div className=\"text-danger my-2\">{error}</div>}\n    </>\n  );\n};\n\nexport default function ProductPreSaleForm(props) {\n  const { product, ctx } = props;\n  const { cart, lead_id } = ctx;\n\n  const cartItem = cart?.items?.find((i) => i.slug === product.slug);\n  const cartItemSlug = cartItem?.item_slug;\n\n  const form = useForm({ name: '', number: '', email: '', ig_handle: '', size: cartItem?.size || '' });\n\n  if (!product || !product.slug || !product.is_pre_sale) return null;\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    if (!form.values.size) return form.setErrors({ ...form.errors, size: ERROR_MSG.size_empty });\n\n    if (!lead_id) {\n      const { name } = form.values;\n      if (!name || name.length < 4) return form.setErrors({ ...form.errors, name: ERROR_MSG.name_length });\n\n      const number = stripNonDigits(form.values.number);\n      if (!number || number.length < 6) return form.setErrors({ ...form.errors, number: ERROR_MSG.number_length });\n    }\n\n    if (cartItemSlug) {\n      return cartService\n        .patch(cart.slug, { action: 'update', slug: cartItemSlug, size: form.values.size })\n        .catch((err) => {\n          form.handleError(err);\n        })\n        .then((data) => {\n          window.location.reload();\n        });\n    }\n\n    return cartService\n      .post({ ...form.values, product: product.slug })\n      .catch((err) => form.handleError(err))\n      .then(() => window.location.reload());\n  };\n\n  return (\n    <div className=\"product-pre-sale\">\n      {!lead_id && (\n        <div className=\"mb-2\">\n          Veuillez entrer votre nom et numéro et nous vous contacterons dès que cet article sera disponible.\n        </div>\n      )}\n\n      {cartItemSlug && (\n        <div className=\"lead-success-msg\">\n          <Icons.InfoCircle className=\"icon\" />\n          <div>Nous vous contaterons dès que cet article sera disponible.</div>\n        </div>\n      )}\n\n      <Form context={form} method=\"POST\" onSubmit={handleSubmit} className=\"contact-form\">\n        <div className=\"my-3\">\n          <ProductSizeRadio form={form} />\n        </div>\n\n        {!lead_id && <LeadFormFragment form={form} />}\n\n        <div className=\"mb-3\">\n          <Button type=\"submit\" className=\"contact-submit-btn btn btn-primary w-100\">\n            {cartItemSlug ? 'Changer ma taille' : 'Contactez-moi'}\n          </Button>\n        </div>\n      </Form>\n    </div>\n  );\n}\n\n// <button>Sauvegarder pour plus tard</button>\n// <button>VOIR TOUS LES ARTICLES SAUVEGARDÉS</button>\n","import React, { useContext, useEffect } from 'react';\nimport { SharedDataCtx } from '@miq/contexts';\nimport { ImgsHorizontalGallery } from '@miq/components';\n\nimport { formatDate } from '@miq/utils';\nimport { ProductPriceDisplay, BreadCrumbs, ProductAttributeList } from './components';\nimport ProductPreSaleForm from './ProductPreSaleForm';\nimport { ProductsGrid } from './ProductsView';\n\nexport default function ProductPublicView(props) {\n  const ctx = useContext(SharedDataCtx);\n  const { product, similar } = ctx;\n\n  useEffect(() => {\n    // navigator.geolocation.getCurrentPosition(\n    //   (pos) => {\n    //     console.log(pos);\n    //   },\n    //   (err) => console.warn(\"permission was rejected\", err)\n    // );\n  }, []);\n\n  if (!product) return null;\n\n  const { is_pre_sale, is_pre_sale_text, description } = product;\n\n  return (\n    <div className=\"product-view mb-4\" id=\"ProductView\">\n      <div className=\"my-3 px-2\">\n        <BreadCrumbs />\n      </div>\n\n      <div className=\"d-flex flex-column flex-md-row justify-content-center\">\n        <div className=\"w-100 w-md-65\">\n          <div className=\"product-images\">\n            <ImgsHorizontalGallery images={[product.cover, ...product?.images]} mobileOnly />\n          </div>\n        </div>\n\n        <div className=\"w-100 w-md-35 p-1\">\n          <div className=\"product-detail\" style={{ position: 'sticky', top: 0 }}>\n            <h1 className=\"product-name text-md fw-lighter\">{product.name}</h1>\n\n            <ProductPriceDisplay product={product} />\n\n            <div className=\"mb-3\">\n              <ProductPreSaleDate product={product} />\n            </div>\n\n            {is_pre_sale && is_pre_sale_text && <div className=\"pre-sale-text mb-3\">{is_pre_sale_text}</div>}\n\n            <ProductPreSaleForm\n              ctx={ctx}\n              product={product}\n              match={props?.match}\n              location={props?.location}\n              history={props?.history}\n            />\n\n            {description && <div className=\"product-description mb-3\">{description}</div>}\n\n            <ul className=\"mb-3\">\n              {product?.has_attributes && (\n                <>\n                  <li className=\"fw-bold mb-1\">Détails</li>\n                  <li className=\"mb-3\">\n                    <ProductAttributeList product={product} />\n                  </li>\n                </>\n              )}\n\n              <li className=\"fw-bold mb-1\">Livraison</li>\n              <li className=\"mb-3\">\n                <p className=\"mb-2\">\n                  Livraison standard gratuite sur Cotonou pour les commandes de 50000 CFA et plus.\n                  <br />\n                  Le délai de traitement de la livraison standard pour cet article est estimé à 1 à 5 jours ouvrables.\n                </p>\n                {/* <a href=\".\" className=\"text-underline\">\n                  Consultez notre page Livraison\n                </a> */}\n              </li>\n            </ul>\n\n            {/* <div className=\"mb-3\">\n              <div className=\"text-md\">Porter avec</div>\n            </div> */}\n          </div>\n        </div>\n      </div>\n\n      {similar && (\n        <div className=\"p-2\">\n          <p className=\"text-md mb-2\">Voir les styles semblables</p>\n          <ProductsGrid items={similar} match={props.match} />\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst ProductPreSaleDate = ({ product }) => {\n  if (!product || !product.is_pre_sale || !product.is_pre_sale_dt) return null;\n  return (\n    <div className=\"product-pre-sale-dt\">\n      Ce produit sera disponible le{' '}\n      <span className=\"dt\">\n        {formatDate(product.is_pre_sale_dt, { day: 'numeric', month: 'short', year: 'numeric' }, 'fr')}\n      </span>\n    </div>\n  );\n};\n"],"sourceRoot":""}