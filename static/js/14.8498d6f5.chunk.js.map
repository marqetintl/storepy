{"version":3,"sources":["shop/public/components.jsx","shop/public/ProductsView.jsx"],"names":["ProductPriceDisplay","product","retail_price","is_on_sale","className","sale_price","amountWithSymbol","CategoryLinks","props","ctx","useContext","SharedDataCtx","isLoaded","categories","map","cat","href","url","title","name","showCover","cover","src_mobile","thumb_sq","name_truncated","slug","SearchForm","search","location","push","useRef","debounce","history","query","URLSearchParams","action","required","initialValue","get","onChange","e","value","target","length","delete","set","current","path","URL","window","pathname","placeholder","minLength","maxLength","BreadCrumbs","breadcrumbs","role","item","label","ProductsGrid","items","ProductsPublicView","object_list","pagination","page_label","q","match","PreviousAnchor","NextAnchor"],"mappings":"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","file":"static/js/14.8498d6f5.chunk.js","sourcesContent":["import ReactDOM from \"react-dom\";\nimport { useContext, useEffect, useRef, useState } from \"react\";\n\nimport { SharedDataCtx } from \"@miq/contexts\";\n// import Form, { useForm } from \"@miq/form\";\nimport { Img, Picture, SearchTextInput } from \"@miq/components\";\nimport { IS_DEV, debounce } from \"@miq/utils\";\n\nexport const ProductPriceDisplay = ({ product }) => {\n  if (!product || !product.retail_price) return null;\n\n  if (product.is_on_sale) {\n    return (\n      <div className=\"product-price-display d-flex align-items-center\">\n        <div className=\"text-danger fw-bold me-2\">{product.sale_price.amountWithSymbol}</div>\n        <div className=\"text-line-through\">{product.retail_price.amountWithSymbol}</div>\n      </div>\n    );\n  }\n  return (\n    <div className=\"product-price-display d-flex align-items-center\">\n      <div className=\"fw-bold\">{product.retail_price.amountWithSymbol}</div>\n    </div>\n  );\n};\n\nexport const CategoryLinks = (props) => {\n  const ctx = useContext(SharedDataCtx);\n\n  if (!ctx.isLoaded || !ctx.categories) return null;\n\n  // console.log(ctx.categories);\n\n  return (\n    <div className=\"category-links pb-2\">\n      {ctx.categories?.map((cat) => {\n        return (\n          <div className=\"item w-25 w-md-15\" key={cat.slug}>\n            <a href={cat.url} className=\"\" title={cat.name}>\n              {props.showCover && cat?.cover && (\n                <Picture {...cat.cover} src_mobile={cat?.cover?.thumb_sq || cat?.cover?.src_mobile} />\n              )}\n              <div className=\"info\">{cat.name_truncated}</div>\n            </a>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport function SearchForm(props) {\n  const { search } = props.location;\n\n  const push = useRef(debounce((url) => props?.history?.push(url), 300));\n\n  const query = new URLSearchParams(search);\n  const handleSearch = ({ e }) => {\n    const { value } = e.target;\n\n    if (!value || value.length < 3) {\n      query.delete(\"q\");\n    } else {\n      query.set(\"q\", e.target.value);\n    }\n\n    if (!push.current) return;\n\n    const path = new URL(window.location.href);\n    push.current(`${path.pathname}?${query}`);\n  };\n\n  return (\n    <form action=\"/shop/\" className=\"product-search-form\">\n      <SearchTextInput\n        required\n        initialValue={query.get(\"q\")}\n        onChange={handleSearch}\n        className=\"search-input\"\n        placeholder={\"Cherchez un produit ...\"}\n        minLength={3}\n        maxLength={99}\n      />\n    </form>\n  );\n}\n\nexport const BreadCrumbs = (props) => {\n  const { isLoaded, breadcrumbs } = useContext(SharedDataCtx);\n\n  if (!isLoaded || !breadcrumbs) {\n    return null;\n  }\n\n  return (\n    <section className=\"miq-breadcrumbs\" role={\"navigation\"} aria-label=\"breadcrumbs\">\n      {breadcrumbs.map((item) => {\n        return (\n          <a href={item.path} className=\"item\" key={item.label} title={item.title} aria-label={item.title}>\n            {item.label}\n          </a>\n        );\n      })}\n    </section>\n  );\n};\n\n//\n// NOT USED\nexport const ProductDetailImages = ({ product, ...props }) => {\n  const { images = [], cover } = product;\n  const [active, setActive] = useState(cover);\n\n  const [root, setRoot] = useState(null);\n\n  useEffect(() => {\n    if (IS_DEV) return;\n\n    const el = document.getElementById(\"product-detail-images\");\n    if (el) setRoot(el);\n  }, [setRoot]);\n\n  if (!product) return null;\n\n  const render = (\n    <div className=\"product-images d-flex flex-column-reverse flex-sm-row\">\n      <div className=\"thumbnails d-flex flex-row flex-sm-column me-1\">\n        <Img src={cover.thumb} className=\"mb-1\" onClick={() => setActive(cover)} />\n\n        {images.map((img) => (\n          <Img src={img.thumb} onClick={() => setActive(img)} className=\"mb-1\" key={img.src} />\n        ))}\n      </div>\n\n      <div className=\"\">\n        <Img src={active.src} />\n      </div>\n    </div>\n  );\n\n  return IS_DEV ? render : root ? ReactDOM.createPortal(render, root) : null;\n};\n","import React, { useContext } from \"react\";\nimport { SharedDataCtx } from \"@miq/contexts\";\nimport { Picture, Pagination } from \"@miq/components\";\nimport { CategoryLinks, ProductPriceDisplay, SearchForm, BreadCrumbs } from \"./components\";\n\nexport const ProductsGrid = ({ items, ...props }) => {\n  return (\n    <div className=\"products-grid d-grid grid-2 grid-md-3 grid-lg-4\">\n      {items?.map((product) => {\n        return (\n          <a href={`${product.url}`} key={product.slug}>\n            <div className=\"\">\n              <Picture {...product.cover} />\n              <div className=\"product-info\">\n                <div className=\"product-name\">{product.name}</div>\n                <ProductPriceDisplay product={product} />\n              </div>\n            </div>\n          </a>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default function ProductsPublicView(props) {\n  const ctx = useContext(SharedDataCtx);\n\n  if (!ctx.isLoaded) {\n    return null;\n  }\n\n  const { object_list, pagination, page_label } = ctx;\n  const query = new URLSearchParams(props.location.search);\n  const q = query.get(\"q\");\n\n  return (\n    <div className=\"products-view p-1 p-md-3\">\n      <header>\n        <div className=\"miq-container center\">\n          <div className=\"mb-3\">\n            <SearchForm history={props.history} match={props.match} location={props.location} />\n          </div>\n        </div>\n\n        <BreadCrumbs />\n\n        <section className=\"my-2\">{page_label && <h1 aria-label={page_label}>{page_label}</h1>}</section>\n      </header>\n\n      {!q && <CategoryLinks showCover />}\n\n      <div className=\"my-3\">\n        {/* <div className=\"sort-bar\">Trier par</div> */}\n        <ProductsGrid items={object_list} match={props.match} />\n      </div>\n\n      <div className=\"my-3\">\n        <Pagination.PreviousAnchor pagination={pagination} className=\"btn me-2\" />\n        <Pagination.NextAnchor pagination={pagination} label=\"next\" className=\"btn\" />\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}