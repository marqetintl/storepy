"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[465],{3615:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var r=t(8519),i=t(6520),c=t(3576),a=t(3308),s=t(2145),u=t(2134),o=t(2379),l=t(6574),d=t(1823),v=t(2898),h=t(324),f=t(8136),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:e.name||"",description:e.description||"",is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_slug:(null===e||void 0===e?void 0:e.meta_slug)||"",meta_description:(null===e||void 0===e?void 0:e.meta_description)||""}};function m(){var e=(0,i.UO)().catSlug,n=(0,a.cI)(p()),t=(0,u.QT)((function(){return(0,v.D)({slug:e}).retrieve()}),{refreshDeps:[e],onSuccess:function(e){var t=e.data;return n.setValues(p(t))},onError:function(e){e.response}}),r=t.res,o=t.updateData,d=new s.HM(r);if(!d.isSuccess)return null;var m=(0,v.D)(d.data),j=function(e){var n=e.data;return o(n)},b=n.errors;return(0,f.jsx)(c.ZP.View,{title:"Modifier cette cat\xe9gorie",back:"../",requiredPerms:["store.change_category"],className:"cat-staff-update-view",children:(0,f.jsxs)("div",{className:"d-grid grid-md-4",children:[(0,f.jsx)("div",{className:"p-md-1",children:(0,f.jsx)("div",{className:"p-1",children:(0,f.jsx)(x,{instance:m,updateData:o})})}),(0,f.jsxs)("div",{className:"span-md-3 span-lg-2",children:[(0,f.jsx)(c.ZP.Section,{title:"Details",children:(0,f.jsxs)(h.V5,{context:n,instance:m,fields:["name","description"],onSuccess:j,children:[(0,f.jsx)(h.g6.NameField,{label:"Nom de la cat\xe9gorie",error:b.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),(0,f.jsx)(h.g6.DescriptionField,{label:"Description",error:b.description,text:"D\xe9crivez cet cat\xe9gorie."}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(a.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})}),(0,f.jsx)(c.ZP.Section,{title:"SEO",children:(0,f.jsxs)(h.V5,{context:n,instance:m,fields:["meta_title","meta_description","meta_slug"],onSuccess:j,children:[(0,f.jsx)(a.lm,{error:b.meta_title}),(0,f.jsx)(a.uV,{error:b.meta_slug}),(0,f.jsx)(a.bA,{error:b.meta_description}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(a.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})})]}),(0,f.jsx)("div",{className:"span-lg-1",children:(0,f.jsx)("div",{style:{top:0,position:"sticky"},children:m.is_published?(0,f.jsx)(l.Ko,{instance:m,onSuccess:function(e){var n=e.data;return o(n)},children:"D\xe9publier cette cat\xe9gorie"}):(0,f.jsx)(l.H5,{instance:m,onSuccess:function(e){var n=e.data;return o(n)},onError:function(e){return n.handleError(e)},children:"Publier cette cat\xe9gorie"})})})]})})}var x=function(e){var n=e.updateData,t=e.instance,i=(0,a.cI)({view:"src"}),s=c.ZP.Img((null===t||void 0===t?void 0:t.cover_data)||{});if(null===s||void 0===s||!s.slug)return(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:(0,f.jsx)(c.CD,{onSuccess:function(e){var r=e.data;t.update({cover:r.slug}).then((function(e){var t=e.data;return n(t)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})});var u=(0,d.ex)(i.values.view);return(0,f.jsx)(a.ZP,{context:i,className:"p-cover-update-form",children:(0,f.jsx)(c.ZP.Section,{border:!0,title:(0,f.jsx)(c.RC,{onSuccess:function(){return n({cover_data:null,cover:null})},instance:s,className:"btn-danger-3",children:(0,f.jsx)(o.PJ.rF,{})}),actions:(0,f.jsx)(c.K7,{required:!0,name:"view"}),className:"p-image-card",children:(0,f.jsx)(c.Cz,{instance:s,field:i.values.view,onSuccess:function(e){var t=e.data;return n({cover:t.slug,cover_data:t})},children:(0,f.jsx)(u,(0,r.Z)({},s))})})})}},324:function(e,n,t){t.d(n,{CB:function(){return d},V5:function(){return v},g6:function(){return h}});var r=t(8519),i=t(8312),c=t(3308),a=t(2145),s=(t(2411),t(2898)),u=t(8136),o=["instance","fields"],l=["onSuccess","onError","onWillSubmit"],d=function(e){var n=(0,c.cI)({name:""});return(0,u.jsxs)(h,{context:n,onSubmit:function(t){return t.preventDefault(),(0,s.D)().create(n.values).then((function(n){var t;return null===e||void 0===e||null===(t=e.onSuccess)||void 0===t?void 0:t.call(e,n)})).catch((function(t){var r;n.handleError(t),null===e||void 0===e||null===(r=e.onError)||void 0===r||r.call(e,t)}))},children:[(0,u.jsx)("div",{className:"",children:(0,u.jsx)(h.NameField,{error:n.errors.name})}),(0,u.jsx)("div",{className:"my-3",children:(0,u.jsx)(c.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},v=function(e){var n=e.instance,t=void 0===n?(0,a.q9)("Category instance"):n,c=e.fields,s=(0,i.Z)(e,o),d=s.onSuccess,v=s.onError,f=s.onWillSubmit,p=(0,i.Z)(s,l),m=p.context;return(0,u.jsx)(h,(0,r.Z)((0,r.Z)({},p),{},{onSubmit:function(e){e.preventDefault(),null===f||void 0===f||f();var n={};return c.forEach((function(e){var t=m.values[e];null!=t&&(n[e]=t)})),t.update(n).then((function(e){return null===d||void 0===d?void 0:d(e)})).catch((function(e){var n;return v?v(e):null===m||void 0===m||null===(n=m.handleError)||void 0===n?void 0:n.call(m,e)}))}}))},h=function(e){return(0,u.jsx)(c.ZP,(0,r.Z)({},e))};h.NameField=function(e){return(0,u.jsx)(c.wd,(0,r.Z)((0,r.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},h.DescriptionField=function(e){return(0,u.jsx)(c.F$,(0,r.Z)({},e))}},2898:function(e,n,t){t.d(n,{D:function(){return l}});var r=t(8519),i=t(1135),c=t(7411),a=t(2518),s=t(2485),u=t(3576),o=function(e){(0,a.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,i.Z)(this,t),n.apply(this,arguments)}return(0,c.Z)(t,[{key:"publish",value:function(){return this.update({is_published:!0})}},{key:"unpublish",value:function(){return this.update({is_published:!0})}}]),t}(u.x5),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,u.eR)((0,r.Z)((0,r.Z)({},e),{},{dt_published:n}),"categories",o)}},421:function(e,n,t){t.d(n,{K1:function(){return Z},n9:function(){return x},sq:function(){return j},wP:function(){return b}});var r=t(6009),i=t(8519),c=t(9062),a=t(8312),s=t(1408),u=t(3576),o=t(2145),l=t(2379),d=t(3992),v=t(6574),h=t(3793),f=t(8136),p=["productInstance","onSuccess","onError"],m=["data"],x=function(e){var n=e.productInstance,t=e.onSuccess,r=e.onError,s=(0,a.Z)(e,p);return(0,f.jsx)(u.CD,(0,i.Z)((0,i.Z)({className:"btn-primary-3"},s),{},{multiple:!0,onSuccessMulti:function(e){var i=e.map((function(e){var n=e.data;return null===n||void 0===n?void 0:n.slug})).filter((function(e){var t;return!(null!==(t=n.images)&&void 0!==t&&t.includes(e))}));return n.update({images:[].concat((0,c.Z)(n.images),(0,c.Z)(i))}).then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===r||void 0===r?void 0:r(e)}))}}))},j=function(e){var n=e.instance,t=e.onSuccess,r=e.onError,i=e.label;return(0,f.jsxs)(l.pu,{renderHeader:function(){return(0,f.jsxs)("div",{children:["Supprimer '",n.name,"'"]})},renderFooter:function(e){var i=e.setOpen;return(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,f.jsx)(l.zx,{onClick:function(){return i(!1)},children:"Annuler"}),(0,f.jsx)(l.zx,{onClick:function(){return function(e){n.destroy().then((function(r){null===e||void 0===e||e(!1),null===t||void 0===t||t(r),d.u.destroy({slug:n.slug})})).catch((function(e){return null===r||void 0===r?void 0:r(e)}))}(i)},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,f.jsx)("div",{className:"p-3",children:"Are you sure you want to delete this"})},className:(0,o.UT)(["product-delete-button btn-danger-3",e.className]),children:[(0,f.jsx)(l.PJ.rF,{}),i&&(0,f.jsx)("span",{className:"label",children:i})]})},b=function(e){var n,t=e.data,r=((0,a.Z)(e,m),(0,h.Z)(t));return(0,f.jsxs)("div",{className:"p-card-list-item p-1 mb-1",children:[(0,f.jsxs)("div",{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"p-name text-ellipsis",children:r.name_truncated}),(0,f.jsx)("div",{className:"ms-1",children:(0,f.jsx)(v.TK,{show:r.is_published})})]}),(0,f.jsxs)("div",{className:"d-flex",children:[(0,f.jsx)(u.pB.Square,(0,i.Z)({},null===r||void 0===r?void 0:r.cover_data)),(0,f.jsxs)("div",{className:"p-info ps-1",children:[(0,f.jsx)(v._S,(0,i.Z)((0,i.Z)({},r.export()),{},{className:"d-flex flex-wrap"})),(0,f.jsx)("div",{className:"p-category",children:null===(n=r.category_data)||void 0===n?void 0:n.name})]})]})]})},Z=function(e){var n=e.items,t=e.itempath,i=(0,s.lr)(),c=(0,r.Z)(i,1)[0];return(0,f.jsx)("div",{className:"p-card-list-items",children:n.map((function(e){var n="".concat(t).concat(e.slug,"/?").concat(c);return(0,f.jsx)(s.OL,{to:n,children:(0,f.jsx)(b,{data:e})},e.slug)}))})}},3793:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(8519),i=t(1135),c=t(7411),a=t(2518),s=t(2485),u=t(3576),o=function(e){(0,a.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,i.Z)(this,t),n.apply(this,arguments)}return(0,c.Z)(t,[{key:"publish",value:function(){return this.patch("".concat(this._path,"publish/"),{is_published:!0})}},{key:"unpublish",value:function(){return this.patch("".concat(this._path,"publish/"),{is_published:!1})}},{key:"postSize",value:function(e){return this.post("".concat(this._path,"size/new/"),e)}},{key:"patchSize",value:function(e,n){return this.patch("".concat(this._path,"size/").concat(e,"/"),n)}},{key:"deleteSize",value:function(e){return this.delete("".concat(this._path,"size/").concat(e,"/"))}},{key:"postAttribute",value:function(e){return this.post("".concat(this._path,"attribute/new/"),e)}},{key:"patchAttribute",value:function(e,n){return this.patch("".concat(this._path,"attribute/").concat(e,"/"),n)}},{key:"deleteAttribute",value:function(e){return this.delete("".concat(this._path,"attribute/").concat(e,"/"))}},{key:"swapCover",value:function(e){return this.patch("".concat(this._path,"swap-cover/"),{slug:e})}}]),t}(u.x5),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,u.eR)((0,r.Z)((0,r.Z)({},e),{},{dt_published:n}),"products",o)}},6574:function(e,n,t){t.d(n,{nk:function(){return f},_S:function(){return p},H5:function(){return v},TK:function(){return m},Ko:function(){return h}});var r=t(8519),i=t(8312),c=(t(2411),t(2379)),a=t(2145),s=t(8136),u=["instance","onClick","onSuccess","onError"],o=["instance","onClick","onSuccess","onError"],l=["retail_price_data","is_on_sale","sale_price_data"],d=["show"],v=function(e){var n=e.instance,t=(e.onClick,e.onSuccess),a=e.onError,o=(0,i.Z)(e,u);return(0,s.jsx)(c.zx,(0,r.Z)((0,r.Z)({onClick:function(){return n.is_published?null:n.publish().then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===a||void 0===a?void 0:a(e)}))},className:"btn-primary btn-md"},o),{},{disabled:n.is_published}))},h=function(e){var n=e.instance,t=(e.onClick,e.onSuccess),a=e.onError,u=(0,i.Z)(e,o);return(0,s.jsx)(c.zx,(0,r.Z)((0,r.Z)({className:"btn-danger btn-md",onClick:function(){return n.is_published?n.unpublish().then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===a||void 0===a?void 0:a(e)})):null}},u),{},{disabled:!n.is_published}))},f=function(e){var n=e.amountWithSymbol,t=e.className,r=e.sale,i=e.lineThrough;return(0,s.jsx)("div",{className:(0,a.UT)(["miq-price-display",r&&"text-danger",i&&"text-line-through",t]),children:n})},p=function(e){var n=e.retail_price_data,t=e.is_on_sale,c=e.sale_price_data,u=(0,i.Z)(e,l);if(!n)return null;var o=t&&null!=(null===c||void 0===c?void 0:c.amountWithSymbol);return(0,s.jsxs)("div",{className:(0,a.UT)(["miq-product-price-display",u.className]),style:u.style,children:[o&&(0,s.jsx)(f,(0,r.Z)((0,r.Z)({sale:!0},c),{},{className:"miq-sale-price me-1"})),(0,s.jsx)(f,(0,r.Z)((0,r.Z)({},n),{},{lineThrough:o,className:"miq-retail-price"}))]})},m=function(e){var n=e.show,t=(0,i.Z)(e,d);return n?(0,s.jsx)(c.PJ.fU,(0,r.Z)((0,r.Z)({},t),{},{className:"published-icon"})):null};new c.SD},3992:function(e,n,t){t.d(n,{U:function(){return h},u:function(){return v}});var r=t(8312),i=t(1135),c=t(7411),a=t(2518),s=t(2485),u=t(2411),o=t(2578),l=["prefix"],d=function(e){(0,a.Z)(t,e);var n=(0,s.Z)(t);function t(){var e;(0,i.Z)(this,t);for(var c=arguments.length,a=new Array(c),s=0;s<c;s++)a[s]=arguments[s];var u=a.prefix,o=void 0===u?"":u,d=(0,r.Z)(a,l);return(e=n.call(this,d)).prefix=void 0,e.prefix=o,e}return(0,c.Z)(t,[{key:"create",value:function(e){this.emit("".concat(this.prefix,"-create"),e)}},{key:"retrieve",value:function(e){this.emit("".concat(this.prefix,"-retrieve"),e)}},{key:"list",value:function(e){this.emit("".concat(this.prefix,"-list"),e)}},{key:"update",value:function(e){this.emit("".concat(this.prefix,"-update"),e)}},{key:"destroy",value:function(e){this.emit("".concat(this.prefix,"-destroy"),e)}}]),t}(t.n(o)()),v=new d;function h(e,n){u.useEffect((function(){v.on("-create",(function(t){var r;n&&!n(t)||null===(r=e.onCreate)||void 0===r||r.call(e,t)})),v.on("-update",(function(t){var r;n&&!n(t)||null===(r=e.onUpdate)||void 0===r||r.call(e,t)})),v.on("-destroy",(function(t){var r;n&&!n(t)||null===(r=e.onDestroy)||void 0===r||r.call(e,t)}))}),[])}}}]);
//# sourceMappingURL=465.7676153a.chunk.js.map