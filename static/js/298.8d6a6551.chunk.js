"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[298],{7298:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var i=t(8519),r=t(6009),s=t(8312),a=t(2411),c=t(1408),u=t(6520),l=t(3576),o=t(2145),d=t(2379),h=t(3793),p=t(6574),v=t(421),f=t(3992),m=t(3085),x=t(5566),j=t(8136),b=["res"],Z=a.lazy((function(){return t.e(92).then(t.bind(t,4092))})),_=a.lazy((function(){return Promise.all([t.e(823),t.e(275)]).then(t.bind(t,3351))}));function y(){var e,n=(0,x._)(),t=n.res,i=(0,s.Z)(n,b);(0,f.U)({onUpdate:i.updateItem,onDestroy:i.removeItem});var r=new o.HM(t);return r.isSuccess?(0,j.jsxs)(u.Z5,{children:[(0,j.jsx)(u.AW,{path:":prodSlug/",element:(0,j.jsx)(g,{response:r})}),(0,j.jsx)(u.AW,{path:"new",element:(0,j.jsx)(Z,{})}),(0,j.jsx)(u.AW,{index:!0,element:(0,j.jsxs)(l.ZP.View,{title:"Products",back:"/staff/store/",actions:(0,j.jsx)(l.ZP.Link,{to:"new/",requiredPerms:["store.add_product"],className:"btn btn-primary-3",children:"Add product"}),requiredPerms:["store.view_product"],children:[(0,j.jsx)(m.ir,{categories:null===(e=r.data)||void 0===e?void 0:e.categories}),(0,j.jsx)(N,{response:r})]})})]}):null}var g=function(e){var n=e.response;return(0,j.jsxs)("div",{className:"d-grid grid-xl-4 gap-1",children:[(0,j.jsx)(d.LY.x9,{children:(0,j.jsx)(v.K1,{items:n.items,itempath:"../"})}),(0,j.jsx)("div",{className:"span-xl-3",children:(0,j.jsx)(_,{back:"/staff/store/products/"})})]})},N=function(e){var n=e.response,t=(0,c.lr)(),s=(0,r.Z)(t,1)[0];return 0===n.items.length?(0,j.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,j.jsx)("p",{className:"fw-light text-md",children:"Add products to your shop to get started"}),(0,j.jsx)("div",{className:"my-4",children:(0,j.jsx)(l.ZP.Link,{to:"new/",requiredPerms:["store.add_product"],className:"btn btn-primary btn-md",children:"Add a new product"})})]}):(0,j.jsxs)("div",{className:"",children:[(0,j.jsx)(d.iA,{items:n.items,header:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.iA.Th,{children:"Product"}),(0,j.jsx)(d.iA.Th,{}),(0,j.jsx)(d.iA.Th,{children:"Price"}),(0,j.jsx)(d.iA.Th,{children:"Availability"})]}),className:"product-staff-table w-100",renderItem:function(e){var n;if(null===e||void 0===e||!e.slug)return null;var t=(0,h.Z)(e),r="".concat(t.slug,"/").concat("".concat(s)?"?".concat(s):"");return(0,j.jsxs)(d.iA.Tr,{children:[(0,j.jsx)(d.iA.Th,{children:(0,j.jsx)(l.pB.Thumb,(0,i.Z)((0,i.Z)({},null===e||void 0===e?void 0:e.cover_data),{},{className:"rounded"}))}),(0,j.jsx)(d.iA.Td,{children:(0,j.jsxs)(l.ZP.Link,{to:r,children:[(0,j.jsxs)("div",{className:"text-ellipsis",children:[e.name,(0,j.jsx)(p.TK,{show:e.is_published||!1})]}),(0,j.jsx)("div",{className:"",children:null===(n=e.category_data)||void 0===n?void 0:n.name})]})}),(0,j.jsx)(d.iA.Td,{children:(0,j.jsx)(p.nk,(0,i.Z)((0,i.Z)({},e.retail_price_data),{},{lineThrough:e.is_on_sale}))}),(0,j.jsx)(d.iA.Td,{children:"Av"})]},e.slug)}}),(0,j.jsx)(d.tl,(0,i.Z)((0,i.Z)({},n.data),{},{component:l.ZP.Link,to:!0}))]})}},421:function(e,n,t){t.d(n,{K1:function(){return Z},n9:function(){return x},sq:function(){return j},wP:function(){return b}});var i=t(6009),r=t(8519),s=t(9062),a=t(8312),c=t(1408),u=t(3576),l=t(2145),o=t(2379),d=t(3992),h=t(6574),p=t(3793),v=t(8136),f=["productInstance","onSuccess","onError"],m=["data"],x=function(e){var n=e.productInstance,t=e.onSuccess,i=e.onError,c=(0,a.Z)(e,f);return(0,v.jsx)(u.CD,(0,r.Z)((0,r.Z)({className:"btn-primary-3"},c),{},{multiple:!0,onSuccessMulti:function(e){var r=e.map((function(e){var n=e.data;return null===n||void 0===n?void 0:n.slug})).filter((function(e){var t;return!(null!==(t=n.images)&&void 0!==t&&t.includes(e))}));return n.update({images:[].concat((0,s.Z)(n.images),(0,s.Z)(r))}).then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===i||void 0===i?void 0:i(e)}))}}))},j=function(e){var n=e.instance,t=e.onSuccess,i=e.onError,r=e.label;return(0,v.jsxs)(o.pu,{renderHeader:function(){return(0,v.jsxs)("div",{children:["Supprimer '",n.name,"'"]})},renderFooter:function(e){var r=e.setOpen;return(0,v.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,v.jsx)(o.zx,{onClick:function(){return r(!1)},children:"Annuler"}),(0,v.jsx)(o.zx,{onClick:function(){return function(e){n.destroy().then((function(i){null===e||void 0===e||e(!1),null===t||void 0===t||t(i),d.u.destroy({slug:n.slug})})).catch((function(e){return null===i||void 0===i?void 0:i(e)}))}(r)},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,v.jsx)("div",{className:"p-3",children:"Are you sure you want to delete this"})},className:(0,l.UT)(["product-delete-button btn-danger-3",e.className]),children:[(0,v.jsx)(o.PJ.rF,{}),r&&(0,v.jsx)("span",{className:"label",children:r})]})},b=function(e){var n,t=e.data,i=((0,a.Z)(e,m),(0,p.Z)(t));return(0,v.jsxs)("div",{className:"p-card-list-item p-1 mb-1",children:[(0,v.jsxs)("div",{className:"d-flex align-items-center",children:[(0,v.jsx)("div",{className:"p-name text-ellipsis",children:i.name_truncated}),(0,v.jsx)("div",{className:"ms-1",children:(0,v.jsx)(h.TK,{show:i.is_published})})]}),(0,v.jsxs)("div",{className:"d-flex",children:[(0,v.jsx)(u.pB.Square,(0,r.Z)({},null===i||void 0===i?void 0:i.cover_data)),(0,v.jsxs)("div",{className:"p-info ps-1",children:[(0,v.jsx)(h._S,(0,r.Z)((0,r.Z)({},i.export()),{},{className:"d-flex flex-wrap"})),(0,v.jsx)("div",{className:"p-category",children:null===(n=i.category_data)||void 0===n?void 0:n.name})]})]})]})},Z=function(e){var n=e.items,t=e.itempath,r=(0,c.lr)(),s=(0,i.Z)(r,1)[0];return(0,v.jsx)("div",{className:"p-card-list-items",children:n.map((function(e){var n="".concat(t).concat(e.slug,"/?").concat(s);return(0,v.jsx)(c.OL,{to:n,children:(0,v.jsx)(b,{data:e})},e.slug)}))})}},3793:function(e,n,t){t.d(n,{Z:function(){return o}});var i=t(8519),r=t(1135),s=t(7411),a=t(2518),c=t(2485),u=t(3576),l=function(e){(0,a.Z)(t,e);var n=(0,c.Z)(t);function t(){return(0,r.Z)(this,t),n.apply(this,arguments)}return(0,s.Z)(t,[{key:"publish",value:function(){return this.patch("".concat(this._path,"publish/"),{is_published:!0})}},{key:"unpublish",value:function(){return this.patch("".concat(this._path,"publish/"),{is_published:!1})}},{key:"postSize",value:function(e){return this.post("".concat(this._path,"size/new/"),e)}},{key:"patchSize",value:function(e,n){return this.patch("".concat(this._path,"size/").concat(e,"/"),n)}},{key:"deleteSize",value:function(e){return this.delete("".concat(this._path,"size/").concat(e,"/"))}},{key:"postAttribute",value:function(e){return this.post("".concat(this._path,"attribute/new/"),e)}},{key:"patchAttribute",value:function(e,n){return this.patch("".concat(this._path,"attribute/").concat(e,"/"),n)}},{key:"deleteAttribute",value:function(e){return this.delete("".concat(this._path,"attribute/").concat(e,"/"))}},{key:"swapCover",value:function(e){return this.patch("".concat(this._path,"swap-cover/"),{slug:e})}}]),t}(u.x5),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,u.eR)((0,i.Z)((0,i.Z)({},e),{},{dt_published:n}),"products",l)}},5566:function(e,n,t){t.d(n,{_:function(){return c}});var i=t(6009),r=t(1408),s=t(2134),a=t(3793),c=function(e){var n=(0,r.lr)(),t=(0,i.Z)(n,1)[0],c=t.get("cat"),u=t.get("page"),l=t.get("published"),o=t.get("presale"),d=t.get("sale"),h={page:u,cat:c,published:l,presale:o,sale:d};return e&&(h.supplier_order_slug=e),(0,s.QT)((function(){return(0,a.Z)().list({params:h})}),{refreshDeps:[u,c,l,o,d,e]})}},6574:function(e,n,t){t.d(n,{nk:function(){return v},_S:function(){return f},H5:function(){return h},TK:function(){return m},Ko:function(){return p}});var i=t(8519),r=t(8312),s=(t(2411),t(2379)),a=t(2145),c=t(8136),u=["instance","onClick","onSuccess","onError"],l=["instance","onClick","onSuccess","onError"],o=["retail_price_data","is_on_sale","sale_price_data"],d=["show"],h=function(e){var n=e.instance,t=(e.onClick,e.onSuccess),a=e.onError,l=(0,r.Z)(e,u);return(0,c.jsx)(s.zx,(0,i.Z)((0,i.Z)({onClick:function(){return n.is_published?null:n.publish().then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===a||void 0===a?void 0:a(e)}))},className:"btn-primary btn-md"},l),{},{disabled:n.is_published}))},p=function(e){var n=e.instance,t=(e.onClick,e.onSuccess),a=e.onError,u=(0,r.Z)(e,l);return(0,c.jsx)(s.zx,(0,i.Z)((0,i.Z)({className:"btn-danger btn-md",onClick:function(){return n.is_published?n.unpublish().then((function(e){return null===t||void 0===t?void 0:t(e)})).catch((function(e){return null===a||void 0===a?void 0:a(e)})):null}},u),{},{disabled:!n.is_published}))},v=function(e){var n=e.amountWithSymbol,t=e.className,i=e.sale,r=e.lineThrough;return(0,c.jsx)("div",{className:(0,a.UT)(["miq-price-display",i&&"text-danger",r&&"text-line-through",t]),children:n})},f=function(e){var n=e.retail_price_data,t=e.is_on_sale,s=e.sale_price_data,u=(0,r.Z)(e,o);if(!n)return null;var l=t&&null!=(null===s||void 0===s?void 0:s.amountWithSymbol);return(0,c.jsxs)("div",{className:(0,a.UT)(["miq-product-price-display",u.className]),style:u.style,children:[l&&(0,c.jsx)(v,(0,i.Z)((0,i.Z)({sale:!0},s),{},{className:"miq-sale-price me-1"})),(0,c.jsx)(v,(0,i.Z)((0,i.Z)({},n),{},{lineThrough:l,className:"miq-retail-price"}))]})},m=function(e){var n=e.show,t=(0,r.Z)(e,d);return n?(0,c.jsx)(s.PJ.fU,(0,i.Z)((0,i.Z)({},t),{},{className:"published-icon"})):null};new s.SD},3992:function(e,n,t){t.d(n,{U:function(){return p},u:function(){return h}});var i=t(8312),r=t(1135),s=t(7411),a=t(2518),c=t(2485),u=t(2411),l=t(2578),o=["prefix"],d=function(e){(0,a.Z)(t,e);var n=(0,c.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];var u=a.prefix,l=void 0===u?"":u,d=(0,i.Z)(a,o);return(e=n.call(this,d)).prefix=void 0,e.prefix=l,e}return(0,s.Z)(t,[{key:"create",value:function(e){this.emit("".concat(this.prefix,"-create"),e)}},{key:"retrieve",value:function(e){this.emit("".concat(this.prefix,"-retrieve"),e)}},{key:"list",value:function(e){this.emit("".concat(this.prefix,"-list"),e)}},{key:"update",value:function(e){this.emit("".concat(this.prefix,"-update"),e)}},{key:"destroy",value:function(e){this.emit("".concat(this.prefix,"-destroy"),e)}}]),t}(t.n(l)()),h=new d;function p(e,n){u.useEffect((function(){h.on("-create",(function(t){var i;n&&!n(t)||null===(i=e.onCreate)||void 0===i||i.call(e,t)})),h.on("-update",(function(t){var i;n&&!n(t)||null===(i=e.onUpdate)||void 0===i||i.call(e,t)})),h.on("-destroy",(function(t){var i;n&&!n(t)||null===(i=e.onDestroy)||void 0===i||i.call(e,t)}))}),[])}}}]);
//# sourceMappingURL=298.8d6a6551.chunk.js.map