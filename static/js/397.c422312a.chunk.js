"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[397],{324:function(e,n,r){r.d(n,{CB:function(){return d},V5:function(){return h},g6:function(){return f}});var t=r(8519),i=r(8312),s=r(5603),c=r(2145),l=(r(2411),r(2898)),u=r(8136),a=["instance","fields"],o=["onSuccess","onError","onWillSubmit"],d=function(e){var n=(0,s.cI)({name:""});return(0,u.jsxs)(f,{context:n,onSubmit:function(r){return r.preventDefault(),(0,l.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var t;n.handleError(r),null===e||void 0===e||null===(t=e.onError)||void 0===t||t.call(e,r)}))},children:[(0,u.jsx)("div",{className:"",children:(0,u.jsx)(f.NameField,{error:n.errors.name})}),(0,u.jsx)("div",{className:"my-3",children:(0,u.jsx)(s.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},h=function(e){var n=e.instance,r=void 0===n?(0,c.q9)("Category instance"):n,s=e.fields,l=(0,i.Z)(e,a),d=l.onSuccess,h=l.onError,m=l.onWillSubmit,v=(0,i.Z)(l,o),x=v.context;return(0,u.jsx)(f,(0,t.Z)((0,t.Z)({},v),{},{onSubmit:function(e){e.preventDefault(),null===m||void 0===m||m();var n={};return s.forEach((function(e){var r=x.values[e];null!=r&&(n[e]=r)})),r.update(n).then((function(e){return null===d||void 0===d?void 0:d(e)})).catch((function(e){var n;return h?h(e):null===x||void 0===x||null===(n=x.handleError)||void 0===n?void 0:n.call(x,e)}))}}))},f=function(e){return(0,u.jsx)(s.ZP,(0,t.Z)({},e))};f.NameField=function(e){return(0,u.jsx)(s.wd,(0,t.Z)((0,t.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},f.DescriptionField=function(e){return(0,u.jsx)(s.F$,(0,t.Z)({},e))}},7397:function(e,n,r){r.r(n),r.d(n,{StaffCategory:function(){return f.D},default:function(){return x}});var t=r(8519),i=r(6009),s=r(2411),c=r(6520),l=r(1408),u=r(2782),a=r(2145),o=r(2134),d=r(2379),h=r(6574),f=r(2898),m=r(324),v=r(8136);function x(){var e=(0,c.s0)(),n=(0,l.lr)(),r=(0,i.Z)(n,1)[0].get("page"),t=(0,o.QT)((function(){return(0,f.D)().list({params:{page:r}})}),{refreshDeps:[r]}).res,d=s.useState(!1),h=(0,i.Z)(d,2),x=h[0],p=h[1],Z=new a.HM(t);return Z.isSuccess?(0,v.jsxs)(u.ZP.View,{title:"Cat\xe9gories",back:"/staff/store/",actions:(0,v.jsx)(u.ZP.Button,{onClick:function(){return p(!x)},className:"btn-primary-3",title:"Add a new category",requiredPerms:["store.add_category"],children:"Ajouter"}),requiredPerms:["store.view_category"],children:[x&&(0,v.jsx)("div",{className:"miq-container center",children:(0,v.jsx)(u.ZP.Section,{title:"Add a category",requiredPerms:["store.add_category"],border:!0,children:(0,v.jsx)(m.CB,{onSuccess:function(n){var r=n.data;return e(r.slug)}})})}),0===Z.items.length&&!x&&(0,v.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,v.jsx)("p",{className:"fw-light text-md",children:"Ajouter une cat\xe9gorie pour commencer"}),(0,v.jsx)("div",{className:"my-4",children:(0,v.jsx)(u.ZP.Button,{onClick:function(){return p(!x)},requiredPerms:["store.add_category"],className:"btn btn-primary btn-md",children:"Add a category"})})]}),(0,v.jsx)(j,{r:Z})]}):null}var j=function(e){var n=e.r;return 0===n.items.length?null:(0,v.jsxs)("div",{className:"",children:[(0,v.jsx)(d.iA,{items:n.items,className:"cat-staff-table w-100",header:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.iA.Th,{}),(0,v.jsx)(d.iA.Th,{children:"Cat\xe9gorie"}),(0,v.jsx)(d.iA.Th,{title:"",children:"Produits"})]}),renderItem:function(e){var n=(0,f.D)(e);return(0,v.jsxs)(d.iA.Tr,{children:[(0,v.jsx)(d.iA.Th,{children:(0,v.jsx)("div",{className:"",style:{maxWidth:48},children:(0,v.jsx)(u.ZP.Img.Thumb,(0,t.Z)((0,t.Z)({},n.cover_data),{},{className:"rounded"}))})}),(0,v.jsx)(d.iA.Td,{children:(0,v.jsx)(u.ZP.Link,{to:"".concat(n.slug,"/"),children:(0,v.jsxs)("div",{className:"text-ellipsis",children:[n.name,(0,v.jsx)(h.TK,{show:n.is_published})]})})}),(0,v.jsx)(d.iA.Td,{children:(0,v.jsxs)("ul",{children:[(0,v.jsxs)("li",{children:["Publi\xe9: ",n.published_count]}),(0,v.jsxs)("li",{children:["Non-publi\xe9: ",n.draft_count]}),(0,v.jsxs)("li",{children:["Total: ",n.products_count]})]})})]},e.slug)}}),(0,v.jsx)(d.tl,(0,t.Z)((0,t.Z)({},n.data),{},{component:u.ZP.Link,to:!0}))]})}},2898:function(e,n,r){r.d(n,{D:function(){return o}});var t=r(8519),i=r(1135),s=r(7411),c=r(2518),l=r(2485),u=r(2782),a=function(e){(0,c.Z)(r,e);var n=(0,l.Z)(r);function r(){return(0,i.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"publish",value:function(){return this.update({is_published:!0})}},{key:"unpublish",value:function(){return this.update({is_published:!0})}}]),r}(u.x5),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,u.eR)((0,t.Z)((0,t.Z)({},e),{},{dt_published:n}),"categories",a)}}}]);
//# sourceMappingURL=397.c422312a.chunk.js.map