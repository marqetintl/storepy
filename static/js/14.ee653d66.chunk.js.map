{"version":3,"sources":["shop/public/components.jsx","shop/public/ProductPreSaleForm.jsx","shop/public/ProductView.jsx"],"names":["ProductPriceDisplay","product","retail_price","is_on_sale","className","sale_price","amountWithSymbol","ProductAttributeList","attributes","map","attr","name","value","CategoryLinks","props","ctx","useContext","SharedDataCtx","isLoaded","categories","cat","href","url","title","showCover","cover","src_mobile","thumb_sq","name_truncated","slug","SearchForm","search","location","push","useRef","debounce","history","query","URLSearchParams","action","required","initialValue","get","onChange","e","target","length","delete","set","current","path","URL","window","pathname","placeholder","minLength","maxLength","BreadCrumbs","breadcrumbs","role","item","label","cartService","Service","ERROR_MSG","ProductPreSaleForm","form","useForm","number","email","ig_handle","useState","isOpen","setOpen","cart","cart_id","lead_id","console","log","is_pre_sale_dt","formatDate","labelFirst","onClick","Icon","Icons","Telephone","context","method","onSubmit","preventDefault","values","setErrors","errors","hasErrors","post","catch","err","response","handleError","then","data","reload","Label","TextInput","error","type","valueAsNumber","setValue","Submit","ContactNavLink","ProductPublicView","useEffect","id","images","mobileOnly","style","position","top","match","description","whiteSpace","has_attributes"],"mappings":"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","file":"static/js/14.ee653d66.chunk.js","sourcesContent":["import ReactDOM from 'react-dom'\nimport { useContext, useEffect, useRef, useState } from 'react'\n\nimport { SharedDataCtx } from '@miq/contexts'\n// import Form, { useForm } from \"@miq/form\";\nimport { Img, Picture, SearchTextInput } from '@miq/components'\nimport { IS_DEV } from '@miq/utils'\nimport debounce from 'lodash.debounce'\n\n/**\n * PRODUCT\n */\n\nexport const ProductPriceDisplay = ({ product }) => {\n  if (!product || !product.retail_price) return null\n\n  if (product.is_on_sale) {\n    return (\n      <div className=\"product-price-display d-flex align-items-center\">\n        <div className=\"text-danger fw-bold me-2\">{product.sale_price.amountWithSymbol}</div>\n        <div className=\"text-line-through\">{product.retail_price.amountWithSymbol}</div>\n      </div>\n    )\n  }\n  return (\n    <div className=\"product-price-display d-flex align-items-center\">\n      <div className=\"fw-bold\">{product.retail_price.amountWithSymbol}</div>\n    </div>\n  )\n}\n\nexport const ProductAttributeList = ({ product }) => {\n  const { attributes = [] } = product || {}\n\n  if (!attributes) return null\n\n  return (\n    <ul className=\"product-attr-list\">\n      {attributes?.map((attr) => {\n        return (\n          <li className=\"attr\" key={attr.name}>\n            <span className=\"attr-label\">{attr.name} : </span>\n            <span className=\"attr-value\">{attr.value}</span>\n          </li>\n        )\n      })}\n    </ul>\n  )\n}\n\n/**\n * CATEGORY\n */\n\nexport const CategoryLinks = (props) => {\n  const ctx = useContext(SharedDataCtx)\n\n  if (!ctx.isLoaded || !ctx.categories) return null\n\n  // console.log(ctx.categories);\n\n  return (\n    <div className=\"category-links pb-2\">\n      {ctx.categories?.map((cat) => {\n        return (\n          <div className=\"item w-25 w-md-15\" key={cat.slug}>\n            <a href={cat.url} className=\"\" title={cat.name}>\n              {props.showCover && cat?.cover && (\n                <Picture {...cat.cover} src_mobile={cat?.cover?.thumb_sq || cat?.cover?.src_mobile} />\n              )}\n              <div className=\"info\">{cat.name_truncated}</div>\n            </a>\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport function SearchForm(props) {\n  const { search } = props.location\n\n  const push = useRef(debounce((url) => props?.history?.push(url), 300))\n\n  const query = new URLSearchParams(search)\n  const handleSearch = ({ e }) => {\n    const { value } = e.target\n\n    if (!value || value.length < 3) {\n      query.delete('q')\n    } else {\n      query.set('q', e.target.value)\n    }\n\n    if (!push.current) return\n\n    const path = new URL(window.location.href)\n    push.current(`${path.pathname}?${query}`)\n  }\n\n  return (\n    <form action=\"/shop/\" className=\"product-search-form\">\n      <SearchTextInput\n        required\n        initialValue={query.get('q')}\n        onChange={handleSearch}\n        className=\"search-input\"\n        placeholder={'Cherchez un produit ...'}\n        minLength={3}\n        maxLength={99}\n      />\n    </form>\n  )\n}\n\nexport const BreadCrumbs = (props) => {\n  const { isLoaded, breadcrumbs } = useContext(SharedDataCtx)\n\n  if (!isLoaded || !breadcrumbs) {\n    return null\n  }\n\n  return (\n    <section className=\"miq-breadcrumbs\" role={'navigation'} aria-label=\"breadcrumbs\">\n      {breadcrumbs.map((item) => {\n        return (\n          <a href={item.path} className=\"item\" key={item.label} title={item.title} aria-label={item.title}>\n            {item.label}\n          </a>\n        )\n      })}\n    </section>\n  )\n}\n\n//\n// NOT USED\nexport const ProductDetailImages = ({ product, ...props }) => {\n  const { images = [], cover } = product\n  const [active, setActive] = useState(cover)\n\n  const [root, setRoot] = useState(null)\n\n  useEffect(() => {\n    if (IS_DEV) return\n\n    const el = document.getElementById('product-detail-images')\n    if (el) setRoot(el)\n  }, [setRoot])\n\n  if (!product) return null\n\n  const render = (\n    <div className=\"product-images d-flex flex-column-reverse flex-sm-row\">\n      <div className=\"thumbnails d-flex flex-row flex-sm-column me-1\">\n        <Img src={cover.thumb} className=\"mb-1\" onClick={() => setActive(cover)} />\n\n        {images.map((img) => (\n          <Img src={img.thumb} onClick={() => setActive(img)} className=\"mb-1\" key={img.src} />\n        ))}\n      </div>\n\n      <div className=\"\">\n        <Img src={active.src} />\n      </div>\n    </div>\n  )\n\n  return IS_DEV ? render : root ? ReactDOM.createPortal(render, root) : null\n}\n","import React, { useState } from 'react'\nimport Form, { useForm } from '@miq/form'\n\nimport { IconButton, Icons } from '@miq/components'\nimport { Service, formatDate } from '@miq/utils'\n\nconst cartService = new Service('/shop/cart/')\n\nconst ERROR_MSG = {\n  name_length: 'Veuillez entrer votre nom et prénom.',\n  number_length: 'Nous ne pouvons pas vous contatcter sans votre numéro.',\n  number_digit: '',\n}\n\nexport default function ProductPreSaleForm(props) {\n  const form = useForm({ name: 'michael', number: '97170307', email: '', ig_handle: '' })\n  const [isOpen, setOpen] = useState(true)\n\n  const { product, ctx } = props\n  if (!product || !product.slug) return null\n\n  const { cart, cart_id, lead_id } = ctx\n\n  console.log(cart, cart_id, lead_id)\n\n  const handleSubmit = (e) => {\n    e.preventDefault()\n    const { name, number } = form.values\n    if (!name || name.length < 4) return form.setErrors({ ...form.errors, name: ERROR_MSG.name_length })\n\n    if (!number || number.length > 8) return form.setErrors({ ...form.errors, number: ERROR_MSG.number_length })\n\n    if (form.hasErrors()) return\n\n    return cartService\n      .post({ ...form.values, product: product.slug })\n      .catch((err) => {\n        console.log(err?.response)\n        form.handleError(err)\n      })\n      .then((data) => {\n        window.location.reload()\n        console.log(data)\n      })\n  }\n\n  const handleNumberChange = (e) => {\n    const { valueAsNumber } = e.target\n    form.setValue('number', valueAsNumber)\n  }\n\n  const { is_pre_sale_dt } = product || {}\n\n  return (\n    <div className=\"\">\n      <p className=\"text-danger\">Ce produit sera disponible le {formatDate(is_pre_sale_dt)}</p>\n      <p className=\"mb-3\">Voulez-vous être contacté dès que ce produit sera disponible?</p>\n\n      {!isOpen && (\n        <div className=\"d-flex justify-content-center mb-3\">\n          <IconButton\n            labelFirst\n            label=\"Contactez-moi\"\n            onClick={() => setOpen(true)}\n            Icon={Icons.Telephone}\n            className=\"fw-bold btn-primary-3\"\n          />\n        </div>\n      )}\n\n      {isOpen && (\n        <div className=\"mb-3\">\n          <Form context={form} method=\"POST\" onSubmit={handleSubmit}>\n            <div className=\"mb-1\">\n              <Form.Label value=\"Nom et prénom\" />\n              <Form.TextInput required name=\"name\" error={form.errors.name} maxLength={99} />\n            </div>\n\n            <div className=\"mb-1\">\n              <Form.Label value=\"Numéro de téléphone/whatsapp\" />\n              <Form.TextInput\n                required\n                name=\"number\"\n                type=\"tel\"\n                value={form.values.number}\n                onChange={handleNumberChange}\n                error={form.errors.number}\n                // minLength={8}\n                maxLength={16}\n              />\n            </div>\n            <div className=\"mb-1\">\n              <Form.Label value=\"Adresse email (facultatif)\" />\n              <Form.TextInput name=\"email\" type=\"email\" minLength={4} />\n            </div>\n            <div className=\"mb-2\">\n              <Form.Label value=\"Instagram (facultatif)\" />\n              <Form.TextInput name=\"ig_handle\" minLength={4} placeholder={`feminity`} />\n            </div>\n\n            <div className=\"mb-3\">\n              <Form.Submit value=\"Contactez-moi\" className=\"btn btn-primary w-100\" />\n            </div>\n          </Form>\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useContext, useEffect } from 'react'\nimport { SharedDataCtx } from '@miq/contexts'\nimport { ImgsHorizontalGallery } from '@miq/components'\n\nimport { ProductPriceDisplay, BreadCrumbs, ProductAttributeList } from './components'\nimport ProductPreSaleForm from './ProductPreSaleForm'\n\nexport const ContactNavLink = (props) => {\n  return (\n    <div className=\"my-3\">\n      <a href=\"/\" target=\"_blank\" className=\"btn btn-primary\">\n        Contactez nous\n      </a>\n    </div>\n  )\n}\n\nexport default function ProductPublicView(props) {\n  const ctx = useContext(SharedDataCtx)\n  const { product } = ctx\n\n  useEffect(() => {\n    // navigator.geolocation.getCurrentPosition(\n    //   (pos) => {\n    //     console.log(pos);\n    //   },\n    //   (err) => console.warn(\"permission was rejected\", err)\n    // );\n  }, [])\n\n  if (!product) return null\n\n  return (\n    <div className=\"product-view\" id=\"ProductView\">\n      <div className=\"my-3 px-2\">\n        <BreadCrumbs />\n      </div>\n\n      <div className=\"d-flex flex-column flex-md-row justify-content-center\">\n        <div className=\"w-100 w-md-65\">\n          <div className=\"\">\n            <ImgsHorizontalGallery images={[product.cover, ...product?.images]} mobileOnly />\n          </div>\n        </div>\n\n        <div className=\"w-100 w-md-35 p-1\">\n          <div style={{ position: 'sticky', top: 0 }}>\n            <h1 className=\"text-md fw-lighter\">{product.name}</h1>\n            <ProductPriceDisplay product={product} />\n\n            {/* {product?.is_pre_sale ? <ProductPreSaleForm product={product} /> : <ContactNavLink />} */}\n            {/* {product?.is_pre_sale && ( */}\n            <ProductPreSaleForm\n              ctx={ctx}\n              product={product}\n              match={props?.match}\n              location={props?.location}\n              history={props?.history}\n            />\n\n            {product.description && (\n              <div className=\"product-info-meta mb-3\" style={{ whiteSpace: 'pre-wrap' }}>\n                {product.description}\n              </div>\n            )}\n\n            <ul className=\"mb-3\">\n              {product?.has_attributes && <li className=\"fw-bold mb-1\">Détails</li>}\n              <li className=\"mb-3\">\n                <ProductAttributeList product={product} />\n              </li>\n\n              <li className=\"fw-bold mb-1\">Livraison</li>\n              <li className=\"mb-3\">\n                <p className=\"mb-2\">\n                  Livraison standard gratuite sur Cotonou pour les commandes de 50000 CFA et plus.\n                  <br />\n                  Le délai de traitement de la livraison standard pour cet article est estimé à 1 à 5 jours ouvrables.\n                </p>\n                {/* <a href=\".\" className=\"text-underline\">\n                  Consultez notre page Livraison\n                </a> */}\n              </li>\n            </ul>\n\n            {/* <div className=\"mb-3\">\n              <div className=\"text-md\">Porter avec</div>\n            </div> */}\n          </div>\n        </div>\n      </div>\n\n      {/* <div className=\"p-2\">\n        <p className=\"text-md\">Voir les styles semblables</p>\n      </div> */}\n    </div>\n  )\n}\n"],"sourceRoot":""}