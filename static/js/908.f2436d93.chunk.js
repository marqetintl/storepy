"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[908,695],{9695:function(e,r,t){t.r(r),t.d(r,{default:function(){return P}});var a=t(8312),n=t(6009),i=t(8519),l=(t(2411),t(1408)),s=t(6520),c=t(3576),o=t(3308),u=t(2134),d=t(2379),p=t(3030),x=t(4093),m=t(6772),v=t(8866),_=t(911),b=t(5394),Z=t(8136),h=["res","setRes","loading"],f=[].concat(["name","category","description","retail_price","is_pre_sale","is_pre_sale_text","is_pre_sale_dt","is_on_sale","sale_price"],["cost","color_group_pk","stage"],["supplier_name","supplier_item_id","supplier_item_sn","supplier_item_category","supplier_item_url","supplier_item_cost","supplier_item_cost_currency","supplier_order_id"],["meta_title","meta_description","meta_slug"]),g={retail_price:0,is_pre_sale:!1,sale_price:0,is_on_sale:!1,is_published:!1},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};return f.forEach((function(t){var a,n=null===e||void 0===e?void 0:e[t];null!=n?r[t]=n:r[t]=null!==(a=g[t])&&void 0!==a?a:""})),(0,i.Z)((0,i.Z)({},g),r)};function P(e){var r,t=e.back,f=(0,s.UO)().prodSlug,g=(0,l.lr)(),P=(0,n.Z)(g,1)[0],S=(0,s.s0)(),F=(0,o.cI)(j()),k=(0,u.QT)((function(){return(0,x.Z)({slug:f}).retrieve()}),{refreshDeps:[f],onSuccess:function(e){var r=e.data;return F.setValues(j(r))},onError:function(e){var r=e.response;if(404===(null===r||void 0===r?void 0:r.status))return S("../")}}),E=k.res,N=k.setRes,C=k.loading,q=(0,a.Z)(k,h),D=new p.HM(E);if(!D.isSuccess)return null;if(C)return(0,Z.jsx)(d.gb,{});var w=(0,x.Z)(D.data),T=function(e){q.updateData(e),b.u.update(e)},I=P.get("tab"),Q={instance:w,form:F,setRes:N,onUpdate:T,navigate:S,back:t,params:P,tab:I,categories:null===D||void 0===D||null===(r=D.data)||void 0===r?void 0:r.categories},R=P.get("page");return(0,Z.jsx)(c.ZP.View,{back:"".concat((0,p.Xs)(t)).concat(R?"?page=".concat(R):""),title:(0,Z.jsx)(_.wP,{data:(0,i.Z)({},w.export())}),requiredPerms:["store.change_product"],className:"product-staff-update-view",children:(0,Z.jsx)(c.ZP.Section,{title:y,actions:w.is_published?(0,Z.jsx)(m.Ko,{instance:w,onSuccess:function(e){var r=e.data;return T(r)},children:"D\xe9publier ce produit"}):(0,Z.jsx)(m.H5,{instance:w,onSuccess:function(e){var r=e.data;return T(r)},onError:function(e){return F.handleError(e)},children:"Publier ce produit"}),children:function(){switch(I){case"inventory":return(0,Z.jsx)(v.W2,(0,i.Z)({},Q));case"settings":return(0,Z.jsx)(v.CW,(0,i.Z)({},Q));case"media":return(0,Z.jsx)(v.EJ,(0,i.Z)({},Q));default:return(0,Z.jsx)(v.wQ,(0,i.Z)({},Q))}}()})})}var y=(0,Z.jsxs)("div",{className:"query-buttons",children:[(0,Z.jsx)(d.$Q,{index:!0,target:"tab",className:"btn-md",children:"Info"}),(0,Z.jsx)(d.$Q,{target:"tab",value:"media",className:"btn-md",children:"Media"}),(0,Z.jsx)(d.$Q,{target:"tab",value:"inventory",className:"btn-md",children:"Inventory"}),(0,Z.jsx)(d.$Q,{target:"tab",value:"settings",className:"btn-md",children:"Settings"})]})},8757:function(e,r,t){t.d(r,{Eh:function(){return E},HG:function(){return C},Kl:function(){return N},iB:function(){return k},ir:function(){return q}});var a=t(6009),n=t(8519),i=t(8312),l=t(2411),s=t(3308),c=t(3030),o=t(5394),u=t(4093),d=t(1408),p=t(8136),x=["instance","categories"],m=["children"],v=["instance","fields","onSuccess","onError"],_=["label","text","error","categories"],b=["label","text","error"],Z=["label","text","error"],h=["label","text","error"],f=["label","text","error"],g=["label","text","error"],j=["label","text","error","stages"],P=["children"],y=["categories"],S=["categories"],F=["children"],k=function(e){var r=e.instance,t=e.categories,a=(0,i.Z)(e,x),l=(0,s.cI)({name:r.name||"",category:r.category||"",description:r.description||"",retail_price:(null===r||void 0===r?void 0:r.retail_price)||0,is_pre_sale:r.is_pre_sale||!1,is_pre_sale_text:r.is_pre_sale_text||""}),c=l.errors,o=e.fields,u=void 0===o?["name","category","description","retail_price","is_pre_sale","is_pre_sale_text"]:o;return(0,p.jsxs)(E,(0,n.Z)((0,n.Z)({},a),{},{context:l,instance:r,fields:u,children:[(0,p.jsx)(C.NameField,{error:c.name}),(0,p.jsx)(C.DescriptionField,{error:c.description}),(0,p.jsxs)("div",{className:"d-grid grid-md-3 gap-2",children:[t&&(0,p.jsx)(C.CategoryField,{categories:t,error:c.category}),(0,p.jsx)(C.RetailPriceField,{error:c.retail_price})]}),(0,p.jsx)(C.PresaleCheckboxField,{label:"En pr\xe9-vente",error:c.is_pre_sale}),l.values.is_pre_sale&&(0,p.jsx)(C.PresaleTextField,{label:"Pre-sale text",placeholder:"Explain ...",error:c.is_pre_sale_text}),(0,p.jsx)(s.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3"})]}))};function E(e){var r=e.children,t=(0,i.Z)(e,m),a=t.instance,l=void 0===a?(0,c.q9)("StaffProduct instance"):a,s=t.fields,u=void 0===s?(0,c.q9)("fields instance"):s,d=t.onSuccess,x=t.onError,_=(0,i.Z)(t,v),b=_.context;return(0,p.jsx)(C,(0,n.Z)((0,n.Z)({},_),{},{onSubmit:function(e){var r;e.preventDefault(),null===t||void 0===t||null===(r=t.onWillSubmit)||void 0===r||r.call(t);var a={};return u.forEach((function(e){var r=b.values[e];null!=r&&("is_pre_sale_dt"!=e||r)&&(a[e]=r)})),l.update(a).then((function(e){var r=e.data;null===d||void 0===d||d(r),o.u.update(r)})).catch((function(e){return x?x(e):b.handleError(e)}))},children:r}))}var N=function(e){var r=(0,s.cI)({name:"",retail_price:"",description:""}),t=r.errors;return(0,p.jsxs)(C,{context:r,onSubmit:function(t){t.preventDefault(),(0,u.Z)().create(r.values).then((function(r){var t;return null===e||void 0===e||null===(t=e.onSuccess)||void 0===t?void 0:t.call(e,r)})).catch((function(e){return r.handleError(e)}))},children:[(0,p.jsx)(C.NameField,{label:"Nom du produit",error:t.name}),(0,p.jsx)(C.RetailPriceField,{required:!1,label:"Prix du produit",error:t.retail_price}),(0,p.jsx)(C.DescriptionField,{label:"Description du produit",error:t.description}),(0,p.jsx)(s.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3"})]})},C=function(e){return(0,p.jsx)(s.ZP,(0,n.Z)({},e))};C.NameField=function(e){return(0,p.jsx)(s.wd,(0,n.Z)({placeholder:"Entrez un titre clair et concis ..."},e))},C.DescriptionField=function(e){return(0,p.jsx)(s.F$,(0,n.Z)({placeholder:"D\xe9crivez les caract\xe9ristiques et les avantages ..."},e))},C.CategoryField=function(e){var r,t=e.label,a=e.text,c=e.error,o=e.categories,u=(0,i.Z)(e,_);return(0,p.jsx)(s.ZP.Field,{label:t,text:a,error:c,children:(0,p.jsx)(s.ZP.Select,(0,n.Z)((0,n.Z)({},u),{},{required:!0,name:"category",nullValue:{label:"S\xe9lectionnez une cat\xe9gorie ..."},children:null===o||void 0===o||null===(r=o.items)||void 0===r?void 0:r.map((function(e){return(0,l.createElement)(s.ZP.Option,(0,n.Z)((0,n.Z)({},e),{},{key:e.value}))}))}))})},C.SalePriceField=function(e){var r=e.label,t=e.text,a=e.error,l=(0,i.Z)(e,b);return(0,p.jsx)(s.ZP.Field,{label:r,text:t,error:a,children:(0,p.jsx)(s.ZP.Text,(0,n.Z)((0,n.Z)({"aria-describedby":"sale_price_label",min:"0",step:"0.01",required:!0,placeholder:"Prix r\xe9duit"},l),{},{type:"number",name:"sale_price"}))})},C.OnSaleCheckboxField=function(e){var r=e.label,t=e.text,a=e.error,l=(0,i.Z)(e,Z);return(0,p.jsx)(s.ZP.Field,{label:r,text:t,error:a,checkbox:!0,children:(0,p.jsx)(s.ZP.Checkbox,(0,n.Z)((0,n.Z)({},l),{},{name:"is_on_sale"}))})},C.PresaleCheckboxField=function(e){var r=e.label,t=e.text,a=e.error,l=(0,i.Z)(e,h);return(0,p.jsx)(s.ZP.Field,{label:r,text:t,error:a,checkbox:!0,children:(0,p.jsx)(s.ZP.Checkbox,(0,n.Z)((0,n.Z)({},l),{},{name:"is_pre_sale"}))})},C.PresaleTextField=function(e){var r=e.label,t=e.text,a=e.error,l=(0,i.Z)(e,f);return(0,p.jsx)(s.ZP.Field,{label:r,text:t,error:a,children:(0,p.jsx)(s.ZP.TextAreaX,(0,n.Z)((0,n.Z)({placeholder:""},l),{},{name:"is_pre_sale_text","aria-describedby":"is_pre_sale_text_label"}))})},C.RetailPriceField=function(e){var r=e.label,t=e.text,a=e.error,l=(0,i.Z)(e,g);return(0,p.jsx)(s.ZP.Field,{label:r,text:t,error:a,children:(0,p.jsx)(s.ZP.Text,(0,n.Z)((0,n.Z)({required:!0,placeholder:"Prix","aria-describedby":"retail_price_label",min:"0",step:"0.01"},l),{},{type:"number",name:"retail_price"}))})},C.StageSelectField=function(e){var r,t=e.label,a=e.text,c=e.error,o=e.stages,u=(0,i.Z)(e,j);return(0,p.jsx)(s.ZP.Field,{label:t,text:a,error:c,children:(0,p.jsx)(s.ZP.Select,(0,n.Z)((0,n.Z)({required:!0,name:"stage",nullValue:{label:"Select stage"}},u),{},{children:null===o||void 0===o||null===(r=o.map)||void 0===r?void 0:r.call(o,(function(e){return(0,l.createElement)(s.ZP.Option,(0,n.Z)((0,n.Z)({},e),{},{key:e.value}))}))}))})};var q=function e(r){var t=r.children,l=(0,i.Z)(r,P),s=(0,d.lr)(),c=(0,a.Z)(s,2),o=c[0],u=c[1],x=l.categories,m=(0,i.Z)(l,y);return(0,p.jsx)("form",(0,n.Z)((0,n.Z)({},m),{},{action:".",method:"GET",onSubmit:function(e){return e.preventDefault()},children:t||(0,p.jsxs)(p.Fragment,{children:[x&&(0,p.jsx)(e.Category,{params:o,setParams:u,categories:x}),(0,p.jsx)(e.Published,{params:o,setParams:u}),(0,p.jsx)(e.Sale,{params:o,setParams:u}),(0,p.jsx)(e.PreSale,{params:o,setParams:u})]})}))};q.Category=function(e){var r=e.categories,t=(0,i.Z)(e,S);return(0,p.jsx)(D,(0,n.Z)((0,n.Z)({emptyLabel:"Categorie ..."},t),{},{name:"cat",children:r.items.map((function(e){return(0,p.jsx)("option",{value:e.value,children:e.label},e.slug)}))}))},q.Published=function(e){return(0,p.jsxs)(D,(0,n.Z)((0,n.Z)({emptyLabel:"Tous les produits ..."},e),{},{name:"published",children:[(0,p.jsx)("option",{value:"include",children:"Produits publi\xe9s"}),(0,p.jsx)("option",{value:"exclude",children:"Produits non publi\xe9s"})]}))};var D=function(e){var r=e.children,t=(0,i.Z)(e,F),a=t.name,n=t.params,l=t.setParams,s=t.emptyLabel;return(0,p.jsxs)("select",{className:"miq-select",name:a,value:n.get(a)||"",onChange:function(e){var r=e.target.value;r?n.set(a,r):n.delete(a),n.delete("page"),l(n)},children:[s&&(0,p.jsx)("option",{value:"",children:s}),r]})};q.PreSale=function(e){return(0,p.jsx)(w,(0,n.Z)((0,n.Z)({},e),{},{name:"presale",label:"En pr\xe9-vente"}))},q.Sale=function(e){return(0,p.jsx)(w,(0,n.Z)((0,n.Z)({},e),{},{name:"sale",label:"En promo"}))};var w=function(e){var r=e.label,t=e.name,a=e.params,n=e.setParams,i=e.inputId;return(0,p.jsxs)("div",{className:(0,c.gj)(["miq-query-filter-toggle d-flex align-items-center"]),children:[(0,p.jsx)("input",{type:"checkbox",className:"miq-checkbox me-1",id:i,onChange:function(e){var r=e.target.checked;r?a.set(t,"".concat(r)):a.delete(t),a.delete("page"),n(a)},checked:Boolean(a.get(t))||!1}),(0,p.jsx)("label",{htmlFor:i,children:r})]})}}}]);
//# sourceMappingURL=908.f2436d93.chunk.js.map