{"version":3,"sources":["shop/public/components.jsx","shop/public/CartView.jsx"],"names":["ProductPriceDisplay","product","retail_price","sale_price","is_on_sale","className","amountWithSymbol","ProductAttributeList","attributes","map","attr","name","value","CategoryLinks","props","ctx","useContext","SharedDataCtx","isLoaded","categories","cat","href","url","title","showCover","cover","src_mobile","thumb_sq","name_truncated","slug","SearchForm","search","location","push","useRef","debounce","history","query","URLSearchParams","action","required","initialValue","get","onChange","e","target","length","delete","set","current","path","URL","window","pathname","placeholder","minLength","maxLength","BreadCrumbs","breadcrumbs","role","item","label","CartPublicView","cart","console","log","items","size","style","top","position","subtotal"],"mappings":"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","file":"static/js/16.81468067.chunk.js","sourcesContent":["import ReactDOM from 'react-dom';\nimport { useContext, useEffect, useRef, useState } from 'react';\n\nimport { SharedDataCtx } from '@miq/contexts';\n// import Form, { useForm } from \"@miq/form\";\nimport { Img, Picture, SearchTextInput } from '@miq/components';\nimport { IS_DEV } from '@miq/utils';\nimport debounce from 'lodash.debounce';\n\n/**\n * PRODUCT\n */\n\nexport const ProductPriceDisplay = ({ product }) => {\n  if (!product || !product.retail_price) return null;\n\n  const { retail_price, sale_price } = product;\n\n  if (product.is_on_sale && sale_price != null) {\n    return (\n      <div className=\"product-price-display d-flex align-items-center\">\n        <div className=\"text-danger fw-bold me-2\">{sale_price.amountWithSymbol}</div>\n        <div className=\"text-line-through\">{retail_price.amountWithSymbol}</div>\n      </div>\n    );\n  }\n  return (\n    <div className=\"product-price-display d-flex align-items-center\">\n      <div className=\"fw-bold\">{retail_price.amountWithSymbol}</div>\n    </div>\n  );\n};\n\nexport const ProductAttributeList = ({ product }) => {\n  const { attributes = [] } = product || {};\n\n  if (!attributes) return null;\n\n  return (\n    <ul className=\"product-attr-list\">\n      {attributes?.map((attr) => {\n        return (\n          <li className=\"attr\" key={attr.name}>\n            <span className=\"attr-label\">{attr.name} : </span>\n            <span className=\"attr-value\">{attr.value}</span>\n          </li>\n        );\n      })}\n    </ul>\n  );\n};\n\n/**\n * CATEGORY\n */\n\nexport const CategoryLinks = (props) => {\n  const ctx = useContext(SharedDataCtx);\n\n  if (!ctx.isLoaded || !ctx.categories) return null;\n\n  // console.log(ctx.categories);\n\n  return (\n    <div className=\"category-links pb-2\">\n      {ctx.categories?.map((cat) => {\n        return (\n          <div className=\"item w-25 w-md-15\" key={cat.slug}>\n            <a href={cat.url} className=\"\" title={cat.name}>\n              {props.showCover && cat?.cover && (\n                <Picture {...cat.cover} src_mobile={cat?.cover?.thumb_sq || cat?.cover?.src_mobile} />\n              )}\n              <div className=\"info\">{cat.name_truncated}</div>\n            </a>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport function SearchForm(props) {\n  const { search } = props.location;\n\n  const push = useRef(debounce((url) => props?.history?.push(url), 300));\n\n  const query = new URLSearchParams(search);\n  const handleSearch = ({ e }) => {\n    const { value } = e.target;\n\n    if (!value || value.length < 3) {\n      query.delete('q');\n    } else {\n      query.set('q', e.target.value);\n    }\n\n    if (!push.current) return;\n\n    const path = new URL(window.location.href);\n    push.current(`${path.pathname}?${query}`);\n  };\n\n  return (\n    <form action=\"/shop/\" className=\"product-search-form\">\n      <SearchTextInput\n        required\n        initialValue={query.get('q')}\n        onChange={handleSearch}\n        className=\"search-input\"\n        placeholder={'Cherchez un produit ...'}\n        minLength={3}\n        maxLength={99}\n      />\n    </form>\n  );\n}\n\nexport const BreadCrumbs = (props) => {\n  const { isLoaded, breadcrumbs } = useContext(SharedDataCtx);\n\n  if (!isLoaded || !breadcrumbs) {\n    return null;\n  }\n\n  return (\n    <section className=\"miq-breadcrumbs\" role={'navigation'} aria-label=\"breadcrumbs\">\n      {breadcrumbs.map((item) => {\n        return (\n          <a href={item.path} className=\"item\" key={item.label} title={item.title} aria-label={item.title}>\n            {item.label}\n          </a>\n        );\n      })}\n    </section>\n  );\n};\n\n//\n// NOT USED\nexport const ProductDetailImages = ({ product, ...props }) => {\n  const { images = [], cover } = product;\n  const [active, setActive] = useState(cover);\n\n  const [root, setRoot] = useState(null);\n\n  useEffect(() => {\n    if (IS_DEV) return;\n\n    const el = document.getElementById('product-detail-images');\n    if (el) setRoot(el);\n  }, [setRoot]);\n\n  if (!product) return null;\n\n  const render = (\n    <div className=\"product-images d-flex flex-column-reverse flex-sm-row\">\n      <div className=\"thumbnails d-flex flex-row flex-sm-column me-1\">\n        <Img src={cover.thumb} className=\"mb-1\" onClick={() => setActive(cover)} />\n\n        {images.map((img) => (\n          <Img src={img.thumb} onClick={() => setActive(img)} className=\"mb-1\" key={img.src} />\n        ))}\n      </div>\n\n      <div className=\"\">\n        <Img src={active.src} />\n      </div>\n    </div>\n  );\n\n  return IS_DEV ? render : root ? ReactDOM.createPortal(render, root) : null;\n};\n","import React, { useContext } from 'react'\nimport { SharedDataCtx } from '@miq/contexts'\nimport { Picture, Pagination } from '@miq/components'\nimport { CategoryLinks, ProductPriceDisplay, SearchForm, BreadCrumbs } from './components'\n\nexport default function CartPublicView(props) {\n  const ctx = useContext(SharedDataCtx)\n\n  if (!ctx.isLoaded) {\n    return null\n  }\n\n  const { cart } = ctx\n\n  console.log(cart)\n\n  return (\n    <div className=\"cart-view d-grid grid-md-3 gap-3 p-1 p-md-3\">\n      <div className=\"cart-items span-md-2\">\n        {cart?.items?.map((item) => {\n          return (\n            <div className=\"cart-item d-grid grid-4 gap-2\" key={item.slug}>\n              <a href={item.url} className=\"d-block\">\n                <Picture {...item.cover} />\n              </a>\n\n              <div className=\"span-3\">\n                <a href={item.url} className=\"item-title d-block fw-bold\">\n                  {item.name}\n                </a>\n\n                {item.size && <div className=\"size\">{item.size}</div>}\n\n                <ProductPriceDisplay product={item} />\n              </div>\n            </div>\n          )\n        })}\n      </div>\n      <div className=\"cart-summary\">\n        <div className=\"sticky\" style={{ top: 0, position: 'sticky' }}>\n          <div className=\"text-md\">Résumé de votre panier</div>\n          <div className=\"d-flex align-items-center justify-content-between\">\n            <span className=\"subtotal-label\">Sous-total:</span>\n            <span className=\"subtotal-amount\">{cart.subtotal.amountWithSymbol}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"sourceRoot":""}