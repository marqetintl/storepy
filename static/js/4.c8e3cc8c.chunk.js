(this["webpackJsonp@store/client"]=this["webpackJsonp@store/client"]||[]).push([[4],{104:function(e,t,c){"use strict";c.d(t,"a",(function(){return j})),c.d(t,"b",(function(){return d})),c.d(t,"c",(function(){return b}));var n=c(1),r=c(23),a=c(36),s=c(28),i=c(27),u=c(7),o=c.n(u),l=c(3),j={data:o.a.shape({slug:o.a.string}).isRequired,context:o.a.shape({isEdit:o.a.bool}).isRequired},d=new(function(e){Object(s.a)(c,e);var t=Object(i.a)(c);function c(e){return Object(r.a)(this,c),t.call(this,e)}return Object(a.a)(c,[{key:"archive",value:function(e){return this.get("".concat(this.path).concat(e,"/archive/"))}}]),c}(l.d))("sections/"),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{results:[]},t=arguments.length>1?arguments[1]:void 0,c=t.type,r=t.payload,a=void 0===r?{}:r,s=a.results;switch(c){case"SET_SECTIONS":return Object(n.a)({},a);case"APPEND_SECTION":return s=addOrUpdateArrayObject(e.results,a,"slug",!0),Object(n.a)(Object(n.a)({},e),{},{results:s});case"PREPEND_SECTION":case"UPDATE_SECTION":return s=addOrUpdateArrayObject(e.results,a),Object(n.a)(Object(n.a)({},e),{},{results:s});case"REMOVE_SECTION":return s=e.results.filter((function(e){return e.slug!==a.slug})),Object(n.a)(Object(n.a)({},e),{},{results:s});default:return Object(n.a)({},e)}}},105:function(e,t,c){"use strict";c.d(t,"a",(function(){return f})),c.d(t,"b",(function(){return h})),c.d(t,"d",(function(){return v})),c.d(t,"c",(function(){return g}));var n=c(4),r=c(1),a=c(5),s=c(3),i=c(104),u=c(107),o=c(16),l=c(0),j=["imgSlug","section"],d=["onCreate","onUpdate"],b=["isUpdated"],O=["form","children"],f=function(e){console.log(e);var t=e.context,c=void 0===t?Object(s.j)("section context"):t,n=e.data,i=void 0===n?Object(s.j)("section data"):n;return Object(l.jsx)(a.c,Object(r.a)(Object(r.a)({},e),{},{Icon:a.e.Trash,className:"section-btn btn-danger",title:"Delete",onClick:function(){return c.remove(i.slug)}}))},h=function(e){var t=e.context,c=void 0===t?Object(s.j)("section context"):t,n=c.isEdit;return Object(l.jsx)(a.c,{Icon:n?a.e.Eye:a.e.PencilSquare,className:"section-btn",title:n?"Preview Mode":"Edit Mode",onClick:function(){return c.setEdit(!n)}})},v=function(e){var t=e.imgSlug,c=e.section,o=void 0===c?Object(s.j)("Section data"):c,O=Object(n.a)(e,j);if(!o.slug)return null;var f=o.type,h=O.onCreate,v=O.onUpdate,g=Object(n.a)(O,d),x=function(e){e.isUpdated;var c=Object(n.a)(e,b),a=c.slug,s=o.images;s.includes(a)||s.push(a);var l=Object(u.a)(Object(r.a)(Object(r.a)({},o),{},{image:c,images:s}));return i.b.patch(o.slug,{type:f,images:s,html:l},{type:f,images:o.images,html:o.html}).then((function(e){if(e.isUpdated){if(t&&v)return v(e);h&&h(e)}}))};return Object(l.jsx)(a.i,Object(r.a)(Object(r.a)({},g),{},{onCreate:x,onUpdate:x,slug:t}))},g=function(e){var t=e.form,c=void 0===t?Object(s.j)("form"):t,r=e.children;Object(n.a)(e,O);return Object(l.jsx)(o.a,{value:c,children:r})};g.TitleInput=function(e){return Object(l.jsx)(o.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Write title..."},e),{},{name:"title"}))},g.TextInput=function(e){return Object(l.jsx)(o.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Write text..."},e),{},{name:"text"}))}},106:function(e,t,c){"use strict";c.d(t,"a",(function(){return a})),c.d(t,"c",(function(){return s})),c.d(t,"b",(function(){return i}));var n=c(3),r=c(0),a=function(e){var t=e.children,c=e.id,a=e.className;return Object(r.jsx)("div",{id:c,className:Object(n.f)(["section-body",a]),children:t})},s=function(e){var t=e.children,c=e.Icon,a=e.id,s=e.className;return Object(r.jsxs)("div",{id:a,className:Object(n.f)(["section-header",s]),children:[c&&Object(r.jsx)("div",{className:"",children:Object(r.jsx)(c,{className:"icon"})}),t]})},i=function(e){var t=e.children,c=e.id,a=e.className;return Object(r.jsx)("div",{id:c,className:Object(n.f)(["section-footer",a]),children:t})}},107:function(e,t,c){"use strict";c.d(t,"a",(function(){return d}));var n=c(1),r=c(114),a=c.n(r),s=c(115),i=c.n(s),u=c(3),o=c(5),l=c(0);i.a.setOptions({renderer:new i.a.Renderer,highlight:function(e,t){var n=c(116),r=n.getLanguage(t)?t:"plaintext";return n.highlight(e,{language:r}).value},pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});var j=function(e){return a.a.renderToStaticMarkup(e)};function d(e){var t=e.type;switch(void 0===t?Object(u.j)("section type"):t){case"MD":return i()(e.text);case"JUMB":return j(Object(l.jsx)(o.k,Object(n.a)({},e)));case"CLOSE":return j(Object(l.jsx)(b,Object(n.a)({},e)));default:return"<div>".concat(e.text,"</div>")}}var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,c=e.text,n=e.image;return Object(l.jsx)("div",{className:"close-template",style:{backgroundImage:n?"url(".concat(n.src,")"):null},children:Object(l.jsx)("div",{className:"close-template-inner",children:Object(l.jsxs)("div",{className:"text-center p-3",children:[t&&Object(l.jsx)("h1",{className:"close-template-title mb-1",children:t}),c&&Object(l.jsx)("h3",{className:"close-template-text",children:c})]})})})}},108:function(e,t,c){},109:function(e,t,c){},110:function(e,t,c){},112:function(e,t,c){"use strict";c.d(t,"d",(function(){return C})),c.d(t,"a",(function(){return w})),c.d(t,"c",(function(){return v})),c.d(t,"b",(function(){return y})),c.d(t,"e",(function(){return N}));var n=c(11),r=c(4),a=c(2),s=c(3),i=(c(108),c(1)),u=c(5),o=c(105),l=c(106),j=(c(109),c(0)),d=function(e){return Object(j.jsx)("div",{className:"",children:"TxtSectionEdit"})},b=function(e){return e.context.isEdit?Object(j.jsx)(d,Object(i.a)({},e)):Object(j.jsx)("div",{className:"",children:"Prev"})},O=Object(a.forwardRef)((function(e,t){return Object(j.jsxs)("div",{id:e.id,ref:t,className:Object(s.f)([e.className]),children:[Object(j.jsx)(l.c,{Icon:u.e.TextareaT}),Object(j.jsx)(l.a,{children:Object(j.jsx)(b,Object(i.a)({},e))}),Object(j.jsx)(l.b,{children:Object(j.jsxs)("div",{className:"actions",children:[Object(j.jsx)(o.a,Object(i.a)(Object(i.a)({},e),{},{label:"Delete"})),Object(j.jsx)(o.b,{context:e.context})]})})]})}));s.b&&(O.displayName="TextSection");var f=O,h=(c(110),Object(a.createContext)());function v(e){var t=e.data,r=void 0===t?Object(s.j)("section data props"):t,u=r.slug,o=r.type,l=Object(a.useRef)(),d=Object(a.useState)(e.isEdit||!1),b=Object(n.a)(d,2),O=b[0],v=b[1],g=Object(a.useMemo)((function(){return{isEdit:O,setEdit:v}}),[O]);if(!u)return null;var x=function(e){switch(e){case"MD":return Object(a.lazy)((function(){return c.e(7).then(c.bind(null,350))}));case"IMG":return Object(a.lazy)((function(){return c.e(9).then(c.bind(null,351))}));case"JUMB":return Object(a.lazy)((function(){return c.e(10).then(c.bind(null,352))}));case"CLOSE":return Object(a.lazy)((function(){return c.e(8).then(c.bind(null,353))}));default:return f}}(o);return Object(j.jsx)(a.Suspense,{fallback:Object(j.jsx)("div",{children:"Loading ..."}),children:Object(j.jsx)(h.Provider,{value:g,children:Object(j.jsx)(x,Object(i.a)(Object(i.a)({},e),{},{context:g,ref:l,className:Object(s.f)(["section",O&&"active"])}))})})}var g=c(104),x=c(23),p=c(28),m=c(27),N=new(function(e){Object(p.a)(c,e);var t=Object(m.a)(c);function c(e){return Object(x.a)(this,c),t.call(this,e)}return c}(s.d))("index/"),S=(new(function(e){Object(p.a)(c,e);var t=Object(m.a)(c);function c(e){return Object(x.a)(this,c),t.call(this,e)}return c}(s.d))("pages/"),["children"]),E=["pageSlug","sourceType"],y=function(e){var t=e.children;Object(r.a)(e,S);return Object(j.jsx)("div",{className:"miq-page-editor",children:t})};y.Sections=function(e){var t=e.pageSlug,c=void 0===t?Object(s.j)("page slug"):t,u=e.sourceType,o=void 0===u?Object(s.j)("page type(page/index)"):u,l=(Object(r.a)(e,E),Object(a.useState)({results:[]})),d=Object(n.a)(l,2),b=d[0],O=d[1];Object(a.useEffect)((function(){c&&g.b.list({source:c,source_type:o}).then((function(e){O(e)}))}),[c,o]);var f=function(e){console.log(e),O(Object(i.a)(Object(i.a)({},b),{},{results:b.results.map((function(t){return t.slug===e.slug?e:t}))}))};return Object(j.jsx)("div",{className:"miq-page-editor-sections",children:b.results.map((function(e){return Object(j.jsx)(v,{data:e,onDataChange:f},e.slug)}))})};var T=["sourceSlug","children"],I=["sourceSlug","request"];function C(e){var t=e.sourceSlug,c=(void 0===t&&Object(s.j)("source slug"),e.children);Object(r.a)(e,T);return Object(j.jsx)("div",{className:"",children:c})}var w=function(e){var t=e.sourceSlug,c=void 0===t?Object(s.j)("source slug"):t,i=e.request,u=void 0===i?Object(s.j)("request"):i,o=(Object(r.a)(e,I),Object(a.useReducer)(g.c,{results:[]})),l=Object(n.a)(o,2),d=l[0],b=l[1];return Object(a.useEffect)((function(){c&&g.b.list(u,{source:c}).then((function(e){b({type:"SET_SECTIONS",payload:e})}))}),[c,u]),Object(j.jsx)("div",{className:"editor-panel",children:Object(j.jsxs)("div",{className:"editor-content",children:[Object(j.jsx)("div",{className:"editor-label"}),Object(j.jsx)("div",{className:"editor-sections",children:d.results.map((function(e){return Object(j.jsx)(v,{data:e},e.slug)}))}),Object(j.jsx)("div",{className:"editor-actions"})]})})}},118:function(e,t,c){"use strict";c.d(t,"a",(function(){return a}));c(19),c(1),c(4);var n=c(3),r=c(24),a={path:"pages/",list:function(e){return Object(n.h)(r.a,this.path,e)},get:function(e,t){return Object(n.h)(r.a,"".concat(this.path).concat(e,"/"),t)}}},342:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return o}));var n=c(11),r=c(2),a=c(112),s=c(118),i=c(24),u=c(0);function o(e){var t=e.match.params.pageSlug,c=Object(r.useState)({}),o=Object(n.a)(c,2),l=o[0],j=o[1];return Object(r.useEffect)((function(){t&&s.a.get(t).then((function(e){return j(e)})).catch((function(e){}))}),[t]),l&&l.slug?Object(u.jsx)(a.d,{sourceSlug:l.slug,className:"",children:Object(u.jsxs)("div",{className:"",children:[l.slug,Object(u.jsx)(a.a,{sourceSlug:l.slug,request:i.a})]})}):null}}}]);
//# sourceMappingURL=4.c8e3cc8c.chunk.js.map