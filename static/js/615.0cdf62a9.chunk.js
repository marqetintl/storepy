"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[615],{3615:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var r=t(8519),i=t(6520),a=t(2782),s=t(5603),c=t(2145),u=t(2134),l=t(2379),o=t(6574),d=t(1823),v=t(2898),m=t(324),f=t(8136),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:e.name||"",description:e.description||"",is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_slug:(null===e||void 0===e?void 0:e.meta_slug)||"",meta_description:(null===e||void 0===e?void 0:e.meta_description)||""}};function x(){var e=(0,i.UO)().catSlug,n=(0,s.cI)(p()),t=(0,u.QT)((function(){return(0,v.D)({slug:e}).retrieve()}),{refreshDeps:[e],onSuccess:function(e){var t=e.data;return n.setValues(p(t))},onError:function(e){e.response}}),r=t.res,l=t.updateData,d=new c.HM(r);if(!d.isSuccess)return null;var x=(0,v.D)(d.data),j=function(e){var n=e.data;return l(n)},g=n.errors;return(0,f.jsx)(a.ZP.View,{title:"Modifier cette cat\xe9gorie",back:"../",requiredPerms:["store.change_category"],className:"cat-staff-update-view",children:(0,f.jsxs)("div",{className:"d-grid grid-md-4",children:[(0,f.jsx)("div",{className:"p-md-1",children:(0,f.jsx)("div",{className:"p-1",children:(0,f.jsx)(h,{instance:x,updateData:l})})}),(0,f.jsxs)("div",{className:"span-md-3 span-lg-2",children:[(0,f.jsx)(a.ZP.Section,{title:"Details",children:(0,f.jsxs)(m.V5,{context:n,instance:x,fields:["name","description"],onSuccess:j,children:[(0,f.jsx)(m.g6.NameField,{label:"Nom de la cat\xe9gorie",error:g.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),(0,f.jsx)(m.g6.DescriptionField,{label:"Description",error:g.description,text:"D\xe9crivez cet cat\xe9gorie."}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(s.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})}),(0,f.jsx)(a.ZP.Section,{title:"SEO",children:(0,f.jsxs)(m.V5,{context:n,instance:x,fields:["meta_title","meta_description","meta_slug"],onSuccess:j,children:[(0,f.jsx)(s.lm,{error:g.meta_title}),(0,f.jsx)(s.uV,{error:g.meta_slug}),(0,f.jsx)(s.bA,{error:g.meta_description}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(s.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})})]}),(0,f.jsx)("div",{className:"span-lg-1",children:(0,f.jsx)("div",{style:{top:0,position:"sticky"},children:x.is_published?(0,f.jsx)(o.Ko,{instance:x,onSuccess:function(e){var n=e.data;return l(n)},children:"D\xe9publier cette cat\xe9gorie"}):(0,f.jsx)(o.H5,{instance:x,onSuccess:function(e){var n=e.data;return l(n)},onError:function(e){return n.handleError(e)},children:"Publier cette cat\xe9gorie"})})})]})})}var h=function(e){var n=e.updateData,t=e.instance,i=(0,s.cI)({view:"src"}),c=a.ZP.Img((null===t||void 0===t?void 0:t.cover_data)||{});if(null===c||void 0===c||!c.slug)return(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:(0,f.jsx)(a.CD,{onSuccess:function(e){var r=e.data;t.update({cover:r.slug}).then((function(e){var t=e.data;return n(t)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})});var u=(0,d.ex)(i.values.view);return(0,f.jsx)(s.ZP,{context:i,className:"p-cover-update-form",children:(0,f.jsx)(a.ZP.Section,{border:!0,title:(0,f.jsx)(a.RC,{onSuccess:function(){return n({cover_data:null,cover:null})},instance:c,className:"btn-danger-3",children:(0,f.jsx)(l.PJ.rF,{})}),actions:(0,f.jsx)(a.K7,{required:!0,name:"view"}),className:"p-image-card",children:(0,f.jsx)(a.Cz,{instance:c,field:i.values.view,onSuccess:function(e){var t=e.data;return n({cover:t.slug,cover_data:t})},children:(0,f.jsx)(u,(0,r.Z)({},c))})})})}},324:function(e,n,t){t.d(n,{CB:function(){return d},V5:function(){return v},g6:function(){return m}});var r=t(8519),i=t(8312),a=t(5603),s=t(2145),c=(t(2411),t(2898)),u=t(8136),l=["instance","fields"],o=["onSuccess","onError","onWillSubmit"],d=function(e){var n=(0,a.cI)({name:""});return(0,u.jsxs)(m,{context:n,onSubmit:function(t){return t.preventDefault(),(0,c.D)().create(n.values).then((function(n){var t;return null===e||void 0===e||null===(t=e.onSuccess)||void 0===t?void 0:t.call(e,n)})).catch((function(t){var r;n.handleError(t),null===e||void 0===e||null===(r=e.onError)||void 0===r||r.call(e,t)}))},children:[(0,u.jsx)("div",{className:"",children:(0,u.jsx)(m.NameField,{error:n.errors.name})}),(0,u.jsx)("div",{className:"my-3",children:(0,u.jsx)(a.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},v=function(e){var n=e.instance,t=void 0===n?(0,s.q9)("Category instance"):n,a=e.fields,c=(0,i.Z)(e,l),d=c.onSuccess,v=c.onError,f=c.onWillSubmit,p=(0,i.Z)(c,o),x=p.context;return(0,u.jsx)(m,(0,r.Z)((0,r.Z)({},p),{},{onSubmit:function(e){e.preventDefault(),null===f||void 0===f||f();var n={};return a.forEach((function(e){var t=x.values[e];null!=t&&(n[e]=t)})),t.update(n).then((function(e){return null===d||void 0===d?void 0:d(e)})).catch((function(e){var n;return v?v(e):null===x||void 0===x||null===(n=x.handleError)||void 0===n?void 0:n.call(x,e)}))}}))},m=function(e){return(0,u.jsx)(a.ZP,(0,r.Z)({},e))};m.NameField=function(e){return(0,u.jsx)(a.wd,(0,r.Z)((0,r.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},m.DescriptionField=function(e){return(0,u.jsx)(a.F$,(0,r.Z)({},e))}},2898:function(e,n,t){t.d(n,{D:function(){return o}});var r=t(8519),i=t(1135),a=t(7411),s=t(2518),c=t(2485),u=t(2782),l=function(e){(0,s.Z)(t,e);var n=(0,c.Z)(t);function t(){return(0,i.Z)(this,t),n.apply(this,arguments)}return(0,a.Z)(t,[{key:"publish",value:function(){return this.update({is_published:!0})}},{key:"unpublish",value:function(){return this.update({is_published:!0})}}]),t}(u.x5),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,u.eR)((0,r.Z)((0,r.Z)({},e),{},{dt_published:n}),"categories",l)}}}]);
//# sourceMappingURL=615.0cdf62a9.chunk.js.map