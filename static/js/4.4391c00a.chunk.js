(this["webpackJsonp@store/clientjs"]=this["webpackJsonp@store/clientjs"]||[]).push([[4],{341:function(e,t,c){"use strict";c.d(t,"d",(function(){return u})),c.d(t,"c",(function(){return d})),c.d(t,"b",(function(){return b})),c.d(t,"e",(function(){return j})),c.d(t,"a",(function(){return h}));c(8),c(4);var n=c(1),a=(c(28),c(2)),r=c(13),i=c(5),l=(c(3),c(50)),s=c.n(l),o=c(0),u=function(e){var t=e.product;if(!t||!t.retail_price)return null;var c=t.retail_price,n=t.sale_price;return t.is_on_sale&&null!=n?Object(o.jsxs)("div",{className:"product-price-display d-flex align-items-center",children:[Object(o.jsx)("div",{className:"text-danger fw-bold me-2",children:n.amountWithSymbol}),Object(o.jsx)("div",{className:"text-line-through",children:c.amountWithSymbol})]}):Object(o.jsx)("div",{className:"product-price-display d-flex align-items-center",children:Object(o.jsx)("div",{className:"fw-bold",children:c.amountWithSymbol})})},d=function(e){var t=(e.product||{}).attributes,c=void 0===t?[]:t;return c?Object(o.jsx)("ul",{className:"product-attr-list",children:null===c||void 0===c?void 0:c.map((function(e){return Object(o.jsxs)("li",{className:"attr",children:[Object(o.jsxs)("span",{className:"attr-label",children:[e.name," : "]}),Object(o.jsx)("span",{className:"attr-value",children:e.value})]},e.name)}))}):null},b=function(e){var t,c=Object(a.useContext)(r.a);return c.isLoaded&&c.categories?Object(o.jsx)("div",{className:"category-links pb-2",children:null===(t=c.categories)||void 0===t?void 0:t.map((function(t){var c,a;return Object(o.jsx)("div",{className:"item w-25 w-md-15",children:Object(o.jsxs)("a",{href:t.url,className:"",title:t.name,children:[e.showCover&&(null===t||void 0===t?void 0:t.cover)&&Object(o.jsx)(i.u,Object(n.a)(Object(n.a)({},t.cover),{},{src_mobile:(null===t||void 0===t||null===(c=t.cover)||void 0===c?void 0:c.thumb_sq)||(null===t||void 0===t||null===(a=t.cover)||void 0===a?void 0:a.src_mobile)})),Object(o.jsx)("div",{className:"info",children:t.name_truncated})]})},t.slug)}))}):null};function j(e){var t=e.location.search,c=Object(a.useRef)(s()((function(t){var c;return null===e||void 0===e||null===(c=e.history)||void 0===c?void 0:c.push(t)}),300)),n=new URLSearchParams(t);return Object(o.jsx)("form",{action:"/shop/",className:"product-search-form",children:Object(o.jsx)(i.v,{required:!0,initialValue:n.get("q"),onChange:function(e){var t=e.e,a=t.target.value;if(!a||a.length<3?n.delete("q"):n.set("q",t.target.value),c.current){var r=new URL(window.location.href);c.current("".concat(r.pathname,"?").concat(n))}},className:"search-input",placeholder:"Cherchez un produit ...",minLength:3,maxLength:99})})}var h=function(e){var t=Object(a.useContext)(r.a),c=t.isLoaded,n=t.breadcrumbs;return c&&n?Object(o.jsx)("section",{className:"miq-breadcrumbs",role:"navigation","aria-label":"breadcrumbs",children:n.map((function(e){return Object(o.jsx)("a",{href:e.path,className:"item",title:e.title,"aria-label":e.title,children:e.label},e.label)}))}):null}},342:function(e,t,c){"use strict";c.d(t,"a",(function(){return l}));var n=c(22),a=c(33),r=c(24),i=c(23),l=new(function(e){Object(r.a)(c,e);var t=Object(i.a)(c);function c(){return Object(n.a)(this,c),t.apply(this,arguments)}return Object(a.a)(c,[{key:"publish",value:function(e){return this.patchPath("".concat(this.path).concat(e,"/publish/"),{})}},{key:"unpublish",value:function(e){return this.patchPath("".concat(this.path).concat(e,"/publish/"),{unpublish:!0})}},{key:"postAttribute",value:function(e,t){return this.postPath("".concat(this.path).concat(e,"/attribute/new/"),t)}},{key:"patchAttribute",value:function(e,t,c,n){return this.patchPath("".concat(this.path).concat(e,"/attribute/").concat(t,"/"),c,n)}},{key:"deleteAttribute",value:function(e,t){return this.deletePath("".concat(this.path).concat(e,"/attribute/").concat(t,"/"))}},{key:"patchPage",value:function(e,t,c){return this.patchPath("".concat(this.path).concat(e,"/page/"),t,c)}},{key:"swapCover",value:function(e,t){return this.patchPath("".concat(this.path).concat(e,"/swap-cover/"),{slug:t})}}]),c}(c(3).f))("products/")},345:function(e,t,c){"use strict";c.d(t,"c",(function(){return f})),c.d(t,"a",(function(){return g})),c.d(t,"d",(function(){return x})),c.d(t,"e",(function(){return N})),c.d(t,"b",(function(){return w}));var n=c(21),a=c(1),r=c(17),i=c(4),l=c(2),s=c(342),o=c(344),u=c(0),d=["children"],b=["items"],j=["image"],h=["prodSlug"],p=["prodSlug","product","toast"],m=["product"],v=function(e){var t=e.children,c=Object(i.a)(e,d),n=c.name,a=c.pushOnChange,r=void 0===a||a,l=c.emptyLabel,s=void 0===l?"Select":l,b=c.history,j=new URL(window.location.href).searchParams;return Object(u.jsxs)("select",{className:Object(o.h)(["miq-select",c.className]),value:j.get(n)||"",onChange:function(e){var t=e.target.value;t?j.set(n,t):j.delete(n),j.delete("page"),r&&function(e){var t=new URL(window.location.href);b.push("".concat(t.pathname,"?").concat(e))}(j)},children:[Object(u.jsx)("option",{value:"",children:s}),t]})},O=function(e){var t,c=e.label,n=e.name,a=e.history,i=e.pushOnChange,l=void 0===i||i,s=e.inputId,d=e.className,b=Object(o.i)();return Object(u.jsxs)("div",{className:Object(o.h)(["miq-query-filter-toggle d-flex align-items-center",d]),children:[Object(u.jsx)("input",(t={type:"checkbox",className:"miq-checkbox",id:s},Object(r.a)(t,"className","me-1"),Object(r.a)(t,"onChange",(function(e){var t=e.target.checked;t?(b.set(n,t),b.delete("page")):b.delete(n),l&&function(){var e=new URL(window.location.href);a.push("".concat(e.pathname,"?").concat(b))}()})),Object(r.a)(t,"checked",Boolean(b.get(n))||!1),t)),Object(u.jsx)("label",{htmlFor:s,children:c})]})},f=function(e){var t=e.children,c=e.className;return Object(u.jsx)("form",{action:".",method:"GET",className:c,onSubmit:function(e){return e.preventDefault()},children:t})};f.CategorySelect=function(e){var t=e.items,c=Object(i.a)(e,b);return Object(u.jsx)(v,Object(a.a)(Object(a.a)({},c),{},{name:"cat",children:null===t||void 0===t?void 0:t.map((function(e){return Object(u.jsx)("option",{value:e.value,children:e.label},e.slug)}))}))},f.PublishedSelect=function(e){return Object(u.jsxs)(v,Object(a.a)(Object(a.a)({},e),{},{name:"published",children:[Object(u.jsx)("option",{value:"include",children:"Produits publi\xe9s"}),Object(u.jsx)("option",{value:"exclude",children:"Produits non publi\xe9s"})]}))},f.PreSaleToggle=function(e){return Object(u.jsx)(O,Object(a.a)(Object(a.a)({},e),{},{name:"presale"}))},f.SaleToggle=function(e){return Object(u.jsx)(O,Object(a.a)(Object(a.a)({},e),{},{name:"sale"}))},f.Select=v,f.Toggle=O;var g=function(e){var t=e.image,c=Object(i.a)(e,j),n=(null===t||void 0===t?void 0:t.alt_text)||"",a=Object(o.j)({alt_text:n}),r=null===t||void 0===t?void 0:t.slug,s=a.setValues;return Object(l.useEffect)((function(){s({alt_text:n})}),[r,s,n]),t&&t.slug?Object(u.jsx)(o.b,{value:a,className:c.className,children:Object(u.jsx)(o.c,{required:!0,image:t,onSuccess:c.onSuccess,onError:c.onError,placeholder:"Add an alternative text ..."})}):null},x=function(e){var t=e.prodSlug,c=Object(i.a)(e,h);if(!t)return null;var n=c.className,a=void 0===n?"btn-danger":n,r=c.label,l=c.onSuccess,d=c.onError;return Object(u.jsx)(o.a,{id:c.id,className:a,onClick:function(){return s.a.delete(t).then((function(){return null===l||void 0===l?void 0:l({prodSlug:t})})).catch((function(e){return null===d||void 0===d?void 0:d(e)}))},children:r||"Supprimer cet article"})};function N(e){var t=e.prodSlug,c=e.product,n=e.toast;Object(i.a)(e,p);if(!t||!(null===c||void 0===c?void 0:c.page))return null;var a=c.page.is_published,r=e.form,l=e.onPublishSuccess,d=e.onUnpublishSuccess,b=e.onError;return Object(u.jsxs)(o.a,{id:e.id,onClick:function(){return a?s.a.unpublish(t).then((function(e){return null===d||void 0===d?void 0:d(e)})).catch((function(e){return null===n||void 0===n?void 0:n.error({message:SHOP_MSGS.default})})):s.a.publish(t).then((function(e){return null===l||void 0===l?void 0:l(e)})).catch((function(e){var t=e.response,c=void 0===t?{}:t;c.data||null===n||void 0===n||n.error({message:SHOP_MSGS.default});var a=c.data,i=a.retail_price,l=a.category,s=a.page;return i&&(null===n||void 0===n||n.error({message:SHOP_MSGS.product.publish_error_retail_price})),l&&(r&&r.handleError(e),null===n||void 0===n||n.error({message:SHOP_MSGS.product.publish_error_category})),s&&(null===n||void 0===n||n.error({message:SHOP_MSGS.product.publish_error_page})),null===b||void 0===b?void 0:b(e)}))},className:Object(o.h)(["staff-product-publish-button",a?"btn-danger":"btn-primary",e.className]),children:[a?"Unpublish":"Publish"," product"]})}var w=function(e){var t=e.product,c=Object(i.a)(e,m);return t&&t.slug?Object(u.jsx)(o.e,{multiple:!0,className:"btn-primary-3",onCreate:function(e){return e=e.filter((function(e){return e&&e.slug})),s.a.patch(t.slug,{images:[].concat(Object(n.a)(t.images),Object(n.a)(e.map((function(e){return e.slug}))))}).then((function(e){c.onCreateSuccess&&c.onCreateSuccess(e)})).catch((function(e){c.onCreateError&&c.onCreateError(e)}))}}):null}},359:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return g}));var n=c(8),a=c(1),r=c(2),i=c(9),l=c(20),s=(c(360),c(13)),o=c(10),u=c(3),d=c(5),b=c(342),j=c(343),h=c(341),p=c(344),m=c(345),v=c(0),O=Object(r.lazy)((function(){return c.e(23).then(c.bind(null,364))})),f=Object(r.lazy)((function(){return c.e(7).then(c.bind(null,367))}));function g(e){var t=e.match,c=t.path,n=t.url;return Object(v.jsxs)(i.c,{children:[Object(v.jsx)(o.e,{path:"".concat(c,"new/"),render:function(e){return Object(v.jsx)(O,Object(a.a)({back:Object(u.g)(n)},e))},requiredPerms:["shop.add_product"]}),Object(v.jsx)(o.e,{requiredPerms:["shop.view_product"],render:function(t){return Object(v.jsx)(x,Object(a.a)(Object(a.a)({},t),{},{back:e.back}))}})]})}var x=function(e){var t,c=e.match.path,h=Object(r.useContext)(s.a).perms,O=Object(r.useState)({loading:!0,data:null,error:null}),g=Object(n.a)(O,2),x=g[0],w=g[1],S=Object(p.i)(),_=S.get("cat"),y=S.get("page"),P=S.get("published"),k=S.get("presale"),C=S.get("sale");Object(r.useEffect)((function(){w({loading:!0,data:null,error:null});var e=new URLSearchParams(window.location.search);e.delete("tab"),b.a.list(e).then((function(e){w({loading:!1,data:e,error:null})})).catch((function(e){w({loading:!1,data:null,error:e})}))}),[_,y,P,k,C]);var L=(null===x||void 0===x?void 0:x.data)||{},q=function(e){if(e){var t=E(e);if(t)return S.set("page",t),function(e){var t=new URL(window.location.href);return"".concat(t.pathname,"?").concat(e)}(S)}},E=function(e){return new URL(e).searchParams.get("page")},T=Object(o.l)(h.perms,["shop.add_product"]),U=function(){var e=q(null===L||void 0===L?void 0:L.previous);if(!e){var t=E(window.location.href);if("2"==="".concat(t))return(e=new URL(window.location.href)).searchParams.delete("page"),"".concat(e.pathname,"?").concat(e.searchParams)}return e}(),R=q(null===L||void 0===L?void 0:L.next),A={state:x,setState:w,prevLink:U,nextLink:R},G={history:e.history};return Object(v.jsxs)(i.c,{children:[Object(v.jsx)(o.e,{path:"".concat(c,":prodSlug/"),render:function(e){return Object(v.jsx)(f,Object(a.a)(Object(a.a)({back:j.b.productList(!0)},e),{},{list:A}))},requiredPerms:["shop.change_product"]}),Object(v.jsx)(o.e,{requiredPerms:["shop.view_product"],children:Object(v.jsxs)(o.g,{title:"Products ".concat(x.loading?"":"(".concat(L.count,")")),back:e.back,actions:Object(v.jsx)(o.d,{label:"Add product",to:"".concat(Object(u.g)(e.match.url),"new/"),disabled:!T,className:"btn-primary"}),children:[Object(v.jsx)("div",{className:"mb-2",children:Object(v.jsx)(m.c,{children:Object(v.jsxs)("div",{className:"d-grid grid-md-4 gap-2",children:[Object(v.jsx)(m.c.CategorySelect,Object(a.a)(Object(a.a)({},G),{},{items:null===L||void 0===L||null===(t=L.categories)||void 0===t?void 0:t.items,emptyLabel:"Filtrer par cat\xe9gorie"})),Object(v.jsx)(m.c.PublishedSelect,Object(a.a)(Object(a.a)({},G),{},{emptyLabel:"Filtrer par status"})),Object(v.jsx)(m.c.PreSaleToggle,Object(a.a)(Object(a.a)({},G),{},{label:"En pr\xe9-vente"})),Object(v.jsx)(m.c.SaleToggle,Object(a.a)(Object(a.a)({},G),{},{label:"En promo"}))]})})}),Object(v.jsxs)(o.g.Section,{className:"product-table mb-3",children:[x.loading&&Object(v.jsx)(d.r,{}),!x.loading&&Object(v.jsx)(d.p,{className:"w-100",items:null===L||void 0===L?void 0:L.results,headers:["","","Add to carts","Price (CFA)","Status"],renderItem:function(e){var t={product:e,query:S};return Object(r.createElement)(N,Object(a.a)(Object(a.a)({},t),{},{key:e.slug}))}})]}),Object(v.jsxs)("div",{className:"mb-3",children:[U&&Object(v.jsx)(l.b,{to:U,className:"btn",children:"Previous"}),R&&Object(v.jsx)(l.b,{to:R,className:"btn",children:"Next"})]})]})})]})},N=function(e){var t,c=e.product,n=null===c||void 0===c?void 0:c.slug;if(!n)return null;var r=c.name,i=c.cover_data,s=c.category_data,o=(c.is_on_sale,c.is_pre_sale);return Object(v.jsxs)(d.w.Tr,{className:"product-row",children:[Object(v.jsx)(d.w.Td,{className:"d-flex product-cover",style:{minWidth:0},children:Object(v.jsx)(d.l,Object(a.a)(Object(a.a)({},i),{},{className:"rounded"}))}),Object(v.jsxs)(d.w.Td,{className:"product-detail",children:[Object(v.jsx)(l.b,{to:j.b.productUpdate(n,!0),children:Object(v.jsx)("div",{className:"fw-bold",title:r,children:r})}),Object(v.jsxs)("div",{className:"text-muted text-sm",children:[s&&Object(v.jsx)("span",{className:"me-1",children:s.name}),o&&Object(v.jsx)("span",{className:"me-1",children:"Pr\xe9-vente"})]})]}),Object(v.jsx)(d.w.Td,{className:"d-none d-md-table-cell text-sm text-center",children:c.add_to_cart_count}),Object(v.jsx)(d.w.Td,{className:"text-center",children:Object(v.jsx)(h.d,{product:c,retail_price:c.retail_price_data,sale_price:c.sale_price_data})}),Object(v.jsx)(d.w.Td,{className:"d-none d-md-table-cell text-sm text-center",children:Object(v.jsx)(p.g,{is_published:null===c||void 0===c||null===(t=c.page)||void 0===t?void 0:t.is_published,pill:!0})})]})}},360:function(e,t,c){}}]);
//# sourceMappingURL=4.4391c00a.chunk.js.map