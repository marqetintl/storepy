(this["webpackJsonp@store/client"]=this["webpackJsonp@store/client"]||[]).push([[6],{331:function(e,t,c){"use strict";c.d(t,"a",(function(){return u}));var n=c(18),r=c(27),a=c(22),s=c(21),u=new(function(e){Object(a.a)(c,e);var t=Object(s.a)(c);function c(e){return Object(n.a)(this,c),t.call(this,e)}return Object(r.a)(c,[{key:"patchPage",value:function(e,t,c){return this.patchPath("".concat(this.path).concat(e,"/page/"),t,c)}}]),c}(c(3).d))("products/")},333:function(e,t,c){"use strict";c.d(t,"f",(function(){return k})),c.d(t,"c",(function(){return w})),c.d(t,"g",(function(){return y})),c.d(t,"b",(function(){return P})),c.d(t,"e",(function(){return I})),c.d(t,"d",(function(){return D})),c.d(t,"a",(function(){return L}));var n=c(30),r=c(13),a=c(1),s=c(4),u=c(2),o=c(23),i=c(8),l=c(10),j=c(5),d=c(331),b=c(0),m=["product"],O=["onSuccess","onError"],f=["product","placeholder","form"],p=["onSuccess","onError"],h=["product","placeholder","form","label"],g=["onSuccess","onError"],v=["product","placeholder","form"],x=["children","form"],S=["onSuccess","onError"],N=["product"],E=["image"],_=["children","product"],C=function(e){var t=e.product;Object(s.a)(e,m);return t?Object(b.jsx)(j.n.Tr,{className:"",children:Object(b.jsx)(j.n.Td,{className:"w-100",children:Object(b.jsx)(o.b,{to:"/staff/shop/products/".concat(t.slug,"/"),children:Object(b.jsx)("div",{className:"mb-1",title:t.name,children:t.name})})})}):null},k=function(e){var t=e.data,c=void 0===t?{results:[]}:t;return Object(b.jsx)("div",{children:Object(b.jsx)(j.j,{className:"w-100",items:c.results,renderItem:function(t){return Object(u.createElement)(C,Object(a.a)(Object(a.a)({},e),{},{product:t,key:t.slug}))},pagination:{count:c.count,next:c.next,previous:c.previous,onPreviousClick:function(e){},onNextClick:function(e){}}})})},U=function(e){var t=e.onSuccess,c=e.onError,n=Object(s.a)(e,O),r=n.product,u=n.placeholder,o=void 0===u?"Give a name to the item":u,l=n.form,j=Object(s.a)(n,f);return l?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(i.b.Label,{value:"Name",className:"mb-1"}),Object(b.jsx)(i.b.TextInput,Object(a.a)(Object(a.a)({},j),{},{required:!0,name:"name",onSave:function(e){var n=e.value;if(n&&r&&r.slug)return d.a.patch(r.slug,{name:n},{name:r.name}).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e)}))},error:l.errors.name,placeholder:o,maxLength:99}))]}):null},w=function(e){var t=e.onSuccess,c=e.onError,n=Object(s.a)(e,p),u=n.product,o=n.placeholder,l=void 0===o?"Give a description to the item":o,j=n.form,m=n.label,O=Object(s.a)(n,h);return u&&j?Object(b.jsxs)(b.Fragment,{children:[m&&Object(b.jsx)(i.b.Label,{value:"Description",className:"mb-1"}),Object(b.jsx)(i.b.TextAreaX,Object(a.a)(Object(a.a)({},O),{},{name:"description",onSave:function(e){var n=e.name,a=e.value;return d.a.patch(u.slug,Object(r.a)({},n,a),Object(r.a)({},n,u[n])).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e)}))},error:j.errors.description,placeholder:l}))]}):null},y=function(e){var t=e.children,c=e.form,n=Object(s.a)(e,x);return c?Object(b.jsx)(i.b,Object(a.a)(Object(a.a)({},n),{},{context:c,children:t})):null};y.NameInput=U,y.DescriptionInput=w,y.SlugPublicInput=function(e){var t=e.onSuccess,c=e.onError,n=Object(s.a)(e,g),r=n.product,u=n.placeholder,o=void 0===u?"Seo slug ...":u,l=n.form,j=Object(s.a)(n,v);return r&&l?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(i.b.Label,{value:"Slug",className:"mb-1"}),Object(b.jsx)(i.b.TextInput,Object(a.a)(Object(a.a)({},j),{},{required:!0,name:"slug_public",onSave:function(e){var n=e.value;return d.a.patch(r.slug,{slug_public:n},{slug_public:r.slug_public}).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e)}))},error:l.errors.slug_public,placeholder:o,maxLength:99}))]}):null};var P=function(e){var t=e.onSuccess,c=e.onError,n=Object(s.a)(e,S),r=Object(i.c)({name:""});return Object(b.jsx)(i.b,Object(a.a)(Object(a.a)({},n),{},{context:r,onSubmit:function(e){return e.preventDefault(),d.a.post({name:r.values.name}).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e);r.handleError(e)}))},children:Object(b.jsx)(U,{form:r,placeholder:"Give a name to the new item ..."})}))},I=function(e){var t=e.product,c=Object(s.a)(e,N);return t&&t.slug?Object(b.jsx)(j.i,{multiple:!0,onCreate:function(e){e=e.filter((function(e){return e&&e.slug})),d.a.patch(t.slug,{images:[].concat(Object(n.a)(t.images),Object(n.a)(e.map((function(e){return e.slug}))))}).then((function(e){c.onCreateSuccess&&c.onCreateSuccess(e)})).catch((function(e){c.onCreateError&&c.onCreateError(e)}))}}):null},D=function(e){var t=e.image,c=Object(s.a)(e,E),n=Object(i.c)({alt_text:t.alt_text||""});return Object(b.jsx)(i.a,{value:n,children:Object(b.jsx)(l.i,{required:!0,image:t,onSuccess:c.onSuccess,onError:c.onError,placeholder:"Add an alternative text ..."})})},L=function(e){var t=e.children,c=e.product,n=Object(s.a)(e,_);if(!c||!c.slug)return null;return Object(b.jsx)(j.i,{slug:c.cover_data?c.cover_data.slug:null,onCreate:function(e){var t=e.slug;d.a.patch(c.slug,{cover:t}).then((function(e){n.onCreateSuccess&&n.onCreateSuccess(e)})).catch((function(e){n.onCreateError&&n.onCreateError(e)}))},onUpdate:function(e){n.onUpdateSuccess&&n.onUpdateSuccess(e)},className:"product-cover-upload-button",children:t})}},341:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return v}));var n=c(30),r=c(9),a=c(4),s=c(1),u=c(2),o=c(8),i=c(10),l=c(5),j=c(333),d=c(331),b=c(0),m=["isUpdated"],O=["product"],f=["data"],p=function(e){var t=e.product,c=e.form,n=e.tab,r=e.onProductUpdate;switch(n){case"price":return Object(b.jsx)(i.g.Section,{title:c.values.name,text:"Upload your item's price"});case"imgs":var u=t.cover_data,o=t.cover;return Object(b.jsxs)(i.g.Section,{title:c.values.name,text:"Upload your item's images",actions:Object(b.jsx)(j.e,{product:t,onCreateSuccess:function(e){return r(e)}}),className:"product-item-images",children:[o&&Object(b.jsxs)("div",{className:"img-item mb-1",children:[Object(b.jsx)(l.f,Object(s.a)(Object(s.a)({},u),{},{className:"product-cover me-1"})),Object(b.jsxs)("div",{className:"flex-1",children:[Object(b.jsx)("div",{className:"mb-1",children:Object(b.jsx)(j.d,{image:u,onSuccess:function(e){e.isUpdated;var c=Object(a.a)(e,m);return r(Object(s.a)(Object(s.a)({},t),{},{cover_data:c,cover:c.slug}))}})}),Object(b.jsx)(l.g,{label:"Delete cover",className:"btn-danger-3",slug:u.slug,onSuccess:function(){return r(Object(s.a)(Object(s.a)({},t),{},{cover_data:null,cover:null}))}})]})]}),t.images_data.map((function(e){return Object(b.jsxs)("div",{className:"img-item mb-1",children:[Object(b.jsx)(l.f,Object(s.a)(Object(s.a)({},e),{},{className:"product-img"})),Object(b.jsxs)("div",{className:"flex-1",children:[Object(b.jsx)("div",{className:"mb-1",children:Object(b.jsx)(j.d,{image:e})}),Object(b.jsx)(l.g,{slug:e.slug,className:"btn-danger-3",onSuccess:function(){return r(Object(s.a)(Object(s.a)({},t),{},{images_data:t.images_data.filter((function(t){return t.slug!==e.slug})),images:t.images.filter((function(t){return t!==e.slug}))}))}})]})]},e.slug)})),Object(b.jsx)("div",{className:"d-grid grid-2 grid-md-3 grid-lg-4 mt-4",children:t.images_data.map((function(e){return Object(b.jsx)("div",{className:"img-grid-item",children:Object(b.jsx)("div",{className:"img-grid-item-content",children:Object(b.jsx)(l.h,Object(s.a)(Object(s.a)({},e),{},{className:"product-img"}))})},e.slug)}))})]});case"desc":return Object(b.jsx)(i.g.Section,{title:c.values.name,text:"Update your item's description",children:Object(b.jsx)(j.c,{product:t,form:c,onSuccess:function(e){},onError:function(e){c.handleError(e)}})});case"vars":return Object(b.jsx)(i.g.Section,{title:c.values.name,text:"Upload your item's variants"});default:return Object(b.jsx)(i.g.Section,{title:c.values.name,text:"/".concat(t.slug_public),children:Object(b.jsxs)("div",{className:"d-flex",children:[Object(b.jsx)("div",{className:"me-1",children:Object(b.jsx)(j.a,{product:t,onCreateSuccess:function(e){r(e)},onCreateError:function(){},onUpdateSuccess:function(e){r(Object(s.a)(Object(s.a)({},t),{},{cover:e.slug,cover_data:e}))},onUpdateError:function(){},children:Object(b.jsx)(l.h,Object(s.a)(Object(s.a)({},t.cover_data),{},{className:"product-cover"}))})}),Object(b.jsx)("div",{className:"flex-1",children:Object(b.jsx)(j.g.NameInput,{product:t,form:c,onSuccess:function(e){},onError:function(e){c.handleError(e)}})})]})})}},h=function(e){var t=e.product,c=Object(a.a)(e,O),n=Object(u.useState)("product"),i=Object(r.a)(n,2),d=i[0],m=i[1],f=Object(o.c)({name:t.name||"",description:t.description||"",slug_public:t.slug_public||"",is_published:t.page.is_published||!1,title:""});return t&&t.slug?Object(b.jsx)("div",{className:"product-item border-1 rounded",children:Object(b.jsxs)(j.g,{form:f,product:t,children:[Object(b.jsxs)("div",{className:"d-flex align-items-center justify-content-between p-1 border-bottom",children:[Object(b.jsxs)("div",{className:"product-item-nav",children:[Object(b.jsx)(l.b,{onClick:function(){return m("product")},children:"Info"}),Object(b.jsx)(l.b,{onClick:function(){return m("desc")},children:"Description"}),Object(b.jsx)(l.b,{onClick:function(){return m("price")},children:"Price"}),Object(b.jsx)(l.b,{onClick:function(){return m("vars")},children:"Variants"}),Object(b.jsx)(l.b,{onClick:function(){return m("imgs")},children:"Images"})]}),Object(b.jsx)("div",{className:"",children:f.values.is_published?Object(b.jsx)("span",{className:"text-green-600",children:"Published"}):Object(b.jsx)("span",{className:"text-muted",children:"Draft"})})]}),Object(b.jsx)("div",{className:"p-1",children:Object(b.jsx)(p,Object(s.a)(Object(s.a)({},c),{},{product:t,tab:d,form:f}))})]})}):null},g=function(e){var t=e.data,c=void 0===t?{results:[]}:t,n=Object(a.a)(e,f);return Object(b.jsx)("div",{className:"product-list",children:c.results.map((function(e){return Object(u.createElement)(h,Object(s.a)(Object(s.a)({},n),{},{product:e,key:e.slug}))}))})};function v(e){var t=Object(u.useState)(!1),c=Object(r.a)(t,2),a=c[0],o=c[1],m=Object(u.useState)({results:[]}),O=Object(r.a)(m,2),f=O[0],p=O[1],h=Object(u.useContext)(l.p),v=e.location.search,x=Object(u.useCallback)((function(){return d.a.list.apply(d.a,arguments)}),[]);Object(u.useEffect)((function(){var e=new URLSearchParams(v);Object(n.a)(e.values()).filter((function(e){return e})).length||(e=null),x(e).then((function(e){p(e)})).catch((function(e){h.error({message:"Something went wrong"})}))}),[x,v,h]);return Object(b.jsxs)(i.g,{title:"Products",actions:Object(b.jsx)(l.b,{onClick:function(){return o(!a)},className:"btn-primary",children:"Add product"}),children:[a&&Object(b.jsx)(i.g.Section,{title:"Add a new product",children:Object(b.jsx)(j.b,{className:"mb-3",onSuccess:function(e){return o(!1),p(Object(s.a)(Object(s.a)({},f),{},{results:[e].concat(Object(n.a)(f.results))}))}})}),Object(b.jsx)(g,{data:f,setData:p,toasts:h,onProductUpdate:function(e){p(Object(s.a)(Object(s.a)({},f),{},{results:f.results.map((function(t){return t.slug===e.slug?e:t}))}))}}),Object(b.jsx)(j.f,{data:f,setData:p,toasts:h})]})}}}]);
//# sourceMappingURL=6.a23e893c.chunk.js.map