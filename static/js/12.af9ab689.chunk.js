(this["webpackJsonp@store/client"]=this["webpackJsonp@store/client"]||[]).push([[12],{341:function(e,t,c){"use strict";c.d(t,"c",(function(){return x})),c.d(t,"b",(function(){return h})),c.d(t,"a",(function(){return g})),c.d(t,"d",(function(){return f}));var s=c(21),r=c(1),n=c(4),a=c(2),l=c(7),i=c(10),u=c(5),o=c(340),d=c(0),b=["onSuccess","onError"],j=["product","placeholder","form"],m=["children","form"],p=["product"],v=["image"],O=["product"],x=function(e){var t=e.children,c=e.form,s=Object(n.a)(e,m);return c?Object(d.jsx)(l.b,Object(r.a)(Object(r.a)({},s),{},{context:c,children:t})):null};x.NameInput=function(e){var t=e.onSuccess,c=e.onError,s=Object(n.a)(e,b),a=s.product,i=s.placeholder,u=void 0===i?"Give a name to the item":i,m=s.form,p=Object(n.a)(s,j),v=null===a||void 0===a?void 0:a.slug;return m?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(l.b.Label,{value:"Name",className:"mb-1"}),Object(d.jsx)(l.b.TextInput,Object(r.a)(Object(r.a)({},p),{},{required:!0,name:"name",onSave:function(e){var s=e.value;if(s&&a&&v)return o.a.patch(v,{name:s},{name:a.name}).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e)}))},error:m.errors.name,placeholder:u,maxLength:99}))]}):null};var h=function(e){var t=e.product,c=Object(n.a)(e,p);return t&&t.slug?Object(d.jsx)(u.k,{multiple:!0,className:"btn-primary-3",onCreate:function(e){return e=e.filter((function(e){return e&&e.slug})),o.a.patch(t.slug,{images:[].concat(Object(s.a)(t.images),Object(s.a)(e.map((function(e){return e.slug}))))}).then((function(e){c.onCreateSuccess&&c.onCreateSuccess(e)})).catch((function(e){c.onCreateError&&c.onCreateError(e)}))}}):null},g=function(e){var t=e.image,c=Object(n.a)(e,v),s=Object(l.c)({alt_text:(null===t||void 0===t?void 0:t.alt_text)||""}),r=null===t||void 0===t?void 0:t.slug,u=null===t||void 0===t?void 0:t.alt_text,o=s.setValues;return Object(a.useEffect)((function(){o({alt_text:u})}),[r,o,u]),t&&t.slug?Object(d.jsx)(l.a,{value:s,className:c.className,children:Object(d.jsx)(i.h,{required:!0,image:t,onSuccess:c.onSuccess,onError:c.onError,placeholder:"Add an alternative text ..."})}):null},f=function(e){var t=e.product;Object(n.a)(e,O);return t?Object(d.jsx)("div",{className:"product-supplier-data",children:Object(d.jsxs)("ul",{children:[Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{className:"",children:"Supplier"}),Object(d.jsx)("span",{className:"",children:t.supplier_name})]}),Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{className:"",children:"Item id"}),Object(d.jsx)("span",{className:"",children:t.supplier_item_id})]}),Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{className:"",children:"Category"}),Object(d.jsx)("span",{className:"",children:t.supplier_item_category})]}),Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{className:"",children:"Item cost"}),Object(d.jsxs)("span",{className:"",children:[t.supplier_item_cost," (",t.supplier_item_cost_currency,")"]})]}),Object(d.jsx)("li",{children:Object(d.jsx)("a",{href:t.supplier_item_url,className:"text-underline",target:"_blank",rel:"noopener noreferrer",children:"View supplier page"})})]})}):null}},345:function(e,t,c){"use strict";c.r(t),c.d(t,"productFormDefaultValues",(function(){return S})),c.d(t,"ProductQuickUpdateForm",(function(){return y})),c.d(t,"default",(function(){return C})),c.d(t,"ProductPublishButton",(function(){return L}));var s=c(20),r=c(1),n=c(8),a=c(4),l=c(2),i=c(10),u=c(7),o=c(3),d=c(5),b=c(340),j=c(341),m=c(0),p=["instance","product"],v=["product"],O=function(e){return Object(m.jsx)(u.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Nom de l'attribut"},e),{},{required:!0,name:"name",maxLength:30,minLength:3}))},x=function(e){return Object(m.jsx)(u.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Valeur de l'attribut"},e),{},{required:!0,name:"value",maxLength:99,minLength:3}))},h=function(e){var t=e.instance,c=e.product,s=Object(a.a)(e,p),r=Object(u.c)({name:(null===t||void 0===t?void 0:t.name)||"",value:(null===t||void 0===t?void 0:t.value)||""});if(!t||!t.slug||!c||!c.slug)return null;return Object(m.jsx)(u.b,{context:r,onSubmit:function(e){return e.preventDefault(),b.a.patchAttribute(c.slug,t.slug,r.values).then((function(e){return null===s||void 0===s?void 0:s.onSuccess(e)})).catch((function(e){return r.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",style:{alignItems:"end"},children:[Object(m.jsx)("div",{className:"me-md-1",children:Object(m.jsx)(O,{error:r.errors.name})}),Object(m.jsx)("div",{className:"w-100 me-md-1",children:Object(m.jsx)(x,{error:r.errors.value})}),Object(m.jsxs)("div",{className:"d-flex ms-md-1",children:[Object(m.jsx)(d.c,{Icon:d.g.Trash,render:function(e){return Object(m.jsx)("div",{className:"p-3 w-100 d-flex justify-content-center",children:Object(m.jsxs)("div",{className:"w-md-50 d-flex align-items-center justify-content-between",children:[Object(m.jsx)("div",{children:Object(m.jsx)(d.b,{onClick:function(){return b.a.deleteAttribute(c.slug,t.slug).then((function(t){return null===e||void 0===e||e.setOpen(!1),null===s||void 0===s?void 0:s.onSuccess(t)})).catch((function(){var e;null===s||void 0===s||null===(e=s.toast)||void 0===e||e.error({message:"Could not delete attribute."})}))},className:"btn-danger",children:"Supprimer"})}),Object(m.jsx)("div",{children:Object(m.jsx)(d.b,{onClick:function(){return null===e||void 0===e?void 0:e.setOpen(!1)},children:"Annuler"})})]})})},renderHeader:function(e){return Object(m.jsx)("div",{className:"p-3",children:Object(m.jsxs)("div",{className:"fw-bold",children:["Supprimer l'attribut \"",t.name,'"']})})},className:"btn-danger-3 me-1"}),Object(m.jsx)(u.b.Submit,{value:"Save",className:"btn btn-primary-2"})]})]})})};function g(e){var t=e.product,c=Object(a.a)(e,v),s={name:"",value:""},r=Object(u.c)(s);if(!t||!t.slug)return null;return Object(m.jsx)(u.b,{context:r,onSubmit:function(e){return e.preventDefault(),b.a.postAttribute(t.slug,r.values).then((function(e){return r.setValues(s),null===c||void 0===c?void 0:c.onSuccess(e)})).catch((function(e){return r.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",style:{alignItems:"end"},children:[Object(m.jsxs)("div",{className:"me-md-1",children:[Object(m.jsx)(u.b.Label,{value:"Name"}),Object(m.jsx)(O,{error:r.errors.name})]}),Object(m.jsxs)("div",{className:"w-100 me-md-1",children:[Object(m.jsx)(u.b.Label,{value:"Value"}),Object(m.jsx)(x,{error:r.errors.value})]}),Object(m.jsx)("div",{className:"ms-md-1",children:Object(m.jsx)(d.d,{type:"submit",className:"btn-primary-3"})})]})})}var f=["tab"],_=["form","product"],N=function(e){var t=e.tab,c=Object(a.a)(e,f),o=c.prodSlug,p=c.product,v=c.setProduct,O=c.form,x=c.toast,_=Object(l.useState)(!1),N=Object(n.a)(_,2),S=N[0],y=N[1];if(!p.slug)return null;switch(t){case"inventory":return Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",children:[Object(m.jsxs)("div",{className:"flex-1",children:[Object(m.jsx)(i.g.Section,{title:"Sizes",text:"Add sizes"}),Object(m.jsxs)(i.g.Section,{title:"Attributes",actions:Object(m.jsx)(d.b,{onClick:function(){return y(!S)},className:"btn-primary-3",children:"Ajouter attribut"}),children:[S&&Object(m.jsxs)("div",{className:"border-bottom mb-2 pb-3",children:[Object(m.jsx)("p",{className:"text-center mb-3",children:"Ajouter un attribut au produit."}),Object(m.jsx)(g,{product:p,onSuccess:function(e){return v(Object(r.a)(Object(r.a)({},p),e))}})]}),Object(m.jsx)("div",{className:"my-3",children:p.attributes.map((function(e){return Object(m.jsx)("div",{className:"mb-1",children:Object(m.jsx)(h,{instance:e,product:p,onSuccess:function(e){return v(Object(r.a)(Object(r.a)({},p),e))}})},e.slug)}))})]})]}),Object(m.jsx)("div",{className:"w-md-35 ms-md-2",children:Object(m.jsx)(j.d,{product:p})})]});case"imgs":return Object(m.jsx)(i.g.Section,{title:"Images",text:"Add images to your product",actions:Object(m.jsx)(j.b,{product:p,onCreateSuccess:function(e){v(Object(r.a)(Object(r.a)({},p),e))}}),children:Object(m.jsx)("div",{className:"d-grid grid-md-3 grid-lg-4",style:{gap:4},children:p.images_data.map((function(e){return Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(d.h,Object(r.a)(Object(r.a)({},e),{},{className:"product-img"})),Object(m.jsxs)("div",{className:"d-flex",children:[Object(m.jsx)(j.a,{image:e}),Object(m.jsx)(d.i,{slug:e.slug,label:"",className:"btn-danger-3 ms-1",onSuccess:function(){v(Object(r.a)(Object(r.a)({},p),{},{images_data:p.images_data.filter((function(t){return t.slug!==e.slug})),images:p.images.filter((function(t){return t!==e.slug}))}))}})]})]},e.slug)}))})});case"setting":return Object(m.jsxs)(u.b,{context:O,onSubmit:function(e){var t,c;e.preventDefault();var s={title:O.values.title,slug_public:O.values.slug_public};return b.a.patchPage(o,s,{title:null===p||void 0===p||null===(t=p.page)||void 0===t?void 0:t.title,slug_public:null===p||void 0===p||null===(c=p.page)||void 0===c?void 0:c.slug_public}).then((function(e){v(Object(r.a)(Object(r.a)({},p),e)),x.success({message:"Product page updated."})})).catch((function(e){O.handleError(e),x.error({message:"Could not update."})}))},children:[Object(m.jsxs)(i.g.Section,{title:"Seo",children:[Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Meta title",className:"mb-1"}),Object(m.jsx)(u.b.TextInput,{required:!0,name:"title",error:O.errors.title,placeholder:"Give a name to the item",maxLength:99})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Slug",className:"mb-1"}),Object(m.jsx)(u.b.TextInput,{required:!0,name:"slug_public",error:O.errors.slug_public,placeholder:"Write slug ...",maxLength:99})]}),Object(m.jsx)("div",{className:"my-2",children:Object(m.jsx)(u.b.Submit,{value:"Update",className:"btn btn-primary-3"})})]}),Object(m.jsx)(i.g.Section,{children:Object(m.jsx)(d.b,{className:"btn-danger",onClick:function(){return b.a.delete(o||p.slug).then((function(e){return null===c||void 0===c?void 0:c.onDelete()})).catch((function(e){null===x||void 0===x||x.error({message:"Something went wrong"})}))},children:"Delete product"})})]});default:return Object(m.jsxs)("div",{className:"d-grid grid-md-3 gap-3",children:[Object(m.jsx)(i.g.Section,{title:"Description",className:"span-md-2",children:Object(m.jsx)(j.c,{form:O,children:Object(m.jsx)(u.b.TextAreaX,{name:"description",onSave:function(e){var t=e.name,c=e.value;return b.a.patch(p.slug,Object(s.a)({},t,c),Object(s.a)({},t,p[t])).then((function(e){v(Object(r.a)(Object(r.a)({},p),e)),x.success({message:"Product updated."})})).catch((function(e){O.handleError(e),x.error({message:"Could not update item."})}))},error:O.errors.description,placeholder:"Give a description to the item"})})}),Object(m.jsx)(i.g.Section,{title:"Status",text:p.page.is_published?"This item is published.":"This item is not published. It does not show in your store.",className:"",children:Object(m.jsx)(L,{product:p,setProduct:v,toast:x})})]})}},S={name:"",description:"",title:"",category:"",slug_public:"",retail_price:0,is_pre_sale:!1,is_pre_sale_text:"",sale_price:0,is_on_sale:!1},y=function(e){var t,c,s=e.form,n=e.product,o=Object(a.a)(e,_),d=o.setProduct,p=o.toast,v=o.categories,O=null===n||void 0===n?void 0:n.slug;Object(l.useEffect)((function(){}),[O]);return Object(m.jsx)(u.b,{context:s,onSubmit:function(e){e.preventDefault();var t={retail_price:s.values.retail_price,is_on_sale:s.values.is_on_sale};return s.values.category&&(t.category=s.values.category),s.values.is_on_sale&&(t.sale_price=s.values.sale_price),s.values.is_pre_sale&&(t.is_pre_sale=s.values.is_pre_sale,t.is_pre_sale_text=s.values.is_pre_sale_text),b.a.patch(n.slug,t).then((function(e){null===d||void 0===d||d(Object(r.a)(Object(r.a)({},n),e)),null===p||void 0===p||p.success({message:"Product updated."})})).catch((function(e){return null===p||void 0===p||p.error({message:"Could not update product."}),s.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-grid grid-md-3 gap-3",children:[Object(m.jsx)("div",{className:"span-md-2",children:Object(m.jsxs)(i.g.Section,{title:"Details",actions:Object(m.jsx)(i.i,{is_published:null===n||void 0===n||null===(t=n.page)||void 0===t?void 0:t.is_published,pill:!0}),children:[Object(m.jsx)("div",{className:"mb-1",children:Object(m.jsx)(j.c.NameInput,{product:n,form:s,onSuccess:function(e){null===d||void 0===d||d(Object(r.a)(Object(r.a)({},n),e)),null===p||void 0===p||p.success({message:"Item updated."})},onError:function(e){s.handleError(e),null===p||void 0===p||p.error({message:"Could not update item."})}})}),v&&Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Category"}),Object(m.jsx)(u.b.SelectInput,{required:!0,name:"category",nullValue:{label:"Select category"},children:null===v||void 0===v||null===(c=v.items)||void 0===c?void 0:c.map((function(e){return Object(l.createElement)(u.b.SelectInput.Option,Object(r.a)(Object(r.a)({},e),{},{key:e.value}))}))})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Retail price",id:"retail_price_label"}),Object(m.jsx)(u.b.TextInput,{required:!0,type:"number",name:"retail_price",error:s.errors.retail_price,"aria-describedby":"retail_price_label",min:"0",step:"0.01"})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[Object(m.jsx)(u.b.CheckboxInput,{name:"is_pre_sale",error:s.errors.is_pre_sale,className:"me-2"}),Object(m.jsx)(u.b.Label,{value:"Pre-sale"})]}),s.values.is_pre_sale&&Object(m.jsxs)("div",{className:"mb-2",children:[Object(m.jsx)(u.b.Label,{value:"Pre sale text",id:"is_pre_sale_text_label",className:"miq-checkbox-label"}),Object(m.jsx)(u.b.TextAreaX,{name:"is_pre_sale_text",error:s.errors.is_pre_sale_text,"aria-describedby":"is_pre_sale_text_label"})]})]}),Object(m.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[Object(m.jsx)(u.b.CheckboxInput,{name:"is_on_sale",error:s.errors.is_on_sale,className:"me-2"}),Object(m.jsx)(u.b.Label,{value:"On Sale"})]}),s.values.is_on_sale&&Object(m.jsxs)("div",{className:"mb-2",children:[Object(m.jsx)(u.b.Label,{value:"Sale price",id:"sale_price_label",className:"miq-checkbox-label"}),Object(m.jsx)(u.b.TextInput,{required:!0,type:"number",name:"sale_price",error:s.errors.sale_price,"aria-describedby":"sale_price_label",min:"0",step:"0.01"})]})]}),Object(m.jsx)("div",{className:"my-3",children:Object(m.jsx)(u.b.Submit,{value:"Update product",className:"btn btn-primary-3"})})]})}),Object(m.jsxs)("div",{className:"",children:[Object(m.jsx)(i.k,{slug:null===n||void 0===n?void 0:n.cover,data:n.cover_data,onCreate:function(e){b.a.patch(n.slug,{cover:e.slug}).then((function(e){null===d||void 0===d||d(Object(r.a)(Object(r.a)({},n),e)),null===p||void 0===p||p.success({message:"Product cover updated."})})).catch((function(e){null===p||void 0===p||p.error({message:"Could not upload cover image."})}))},onUpdate:function(e){return null===p||void 0===p||p.success({message:"Product cover updated."}),null===d||void 0===d?void 0:d(Object(r.a)(Object(r.a)({},n),{},{cover_data:e}))},onDelete:function(){return null===d||void 0===d?void 0:d(Object(r.a)(Object(r.a)({},n),{},{cover_data:null,cover:null}))},className:"mb-1"}),Object(m.jsx)(j.a,{image:null===n||void 0===n?void 0:n.cover_data})]})]})})};function C(e){var t=e.match.params.prodSlug,c=Object(l.useState)(null),s=Object(n.a)(c,2),r=s[0],a=s[1],j=Object(l.useState)("info"),p=Object(n.a)(j,2),v=p[0],O=p[1],x=Object(l.useContext)(d.v),h=Object(u.c)(S),g=h.setValues;return Object(l.useEffect)((function(){b.a.detail(t).then((function(e){var t;a(e),g({name:e.name||"",description:e.description||"",category:e.category||"",retail_price:(null===e||void 0===e?void 0:e.retail_price)||0,is_pre_sale:e.is_pre_sale||!1,is_pre_sale_text:e.is_pre_sale_text||"",is_on_sale:e.is_on_sale||!1,sale_price:(null===e||void 0===e?void 0:e.sale_price)||0,title:e.page.title||"",slug_public:(null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.slug_public)||""})})).catch((function(e){!e.response||(console.log(e.response),e.response.status)}))}),[t,g]),r?Object(m.jsxs)(i.g,{back:null===e||void 0===e?void 0:e.back,actions:Object(m.jsxs)("div",{children:[(null===r||void 0===r?void 0:r.prev_slug)&&Object(m.jsx)("a",{href:"".concat(null===e||void 0===e?void 0:e.back).concat(null===r||void 0===r?void 0:r.prev_slug,"/"),className:"btn me-1",title:"Voir le produit pr\xe9c\xe9dent",children:"Previous"}),(null===r||void 0===r?void 0:r.next_slug)&&Object(m.jsx)("a",{href:"".concat(null===e||void 0===e?void 0:e.back).concat(null===r||void 0===r?void 0:r.next_slug,"/"),className:"btn",title:"Voir le produit suivant",children:"Next"})]}),className:"product-update-view",children:[Object(m.jsx)(y,{form:h,product:r,categories:null===r||void 0===r?void 0:r.categories,setProduct:a,toast:x}),Object(m.jsxs)("div",{className:"my-2",children:[Object(m.jsx)("div",{className:"d-flex justify-content-center mb-3",children:Object(m.jsxs)("div",{className:"d-flex align-items-center",children:[Object(m.jsx)(d.b,{onClick:function(){return O("info")},className:Object(o.g)(["me-1","info"===v&&"btn-primary-3"]),children:"Info"}),Object(m.jsx)(d.b,{onClick:function(){return O("inventory")},className:Object(o.g)(["me-1","inventory"===v&&"btn-primary-3"]),children:"Inventory"}),Object(m.jsx)(d.b,{onClick:function(){return O("imgs")},className:Object(o.g)(["me-1","imgs"===v&&"btn-primary-3"]),children:"Images"}),Object(m.jsx)(d.b,{onClick:function(){return O("setting")},className:Object(o.g)(["setting"===v&&"btn-primary-3"]),children:"Settings"})]})}),Object(m.jsx)(N,{tab:v,prodSlug:t,product:r,setProduct:a,form:h,toast:x,onDelete:function(){var t;return null===e||void 0===e||null===(t=e.history)||void 0===t?void 0:t.push(e.back)}})]})]}):null}var I="You can not publish a product without price",k="You can not publish a product without category",w="You can not publish a product without page",P="Something went awfully wrong!",L=function(e){var t=e.product,c=e.setProduct,s=e.toast;if(!(null===t||void 0===t?void 0:t.page))return null;var n=t.page.is_published;return Object(m.jsxs)(d.b,{onClick:function(){return n?b.a.unpublish(t.slug).then((function(e){return c(Object(r.a)(Object(r.a)({},t),e)),null===s||void 0===s?void 0:s.success({message:"Item unpublished"})})).catch((function(e){return null===s||void 0===s?void 0:s.error({message:P})})):b.a.publish(t.slug).then((function(e){return null===c||void 0===c||c(Object(r.a)(Object(r.a)({},t),e)),null===s||void 0===s?void 0:s.success({message:"Item published"})})).catch((function(e){var t=e.response,c=void 0===t?{}:t;if(!c.data)return null===s||void 0===s?void 0:s.error({message:P});var r=c.data,n=r.retail_price,a=r.category,l=r.page;return n?null===s||void 0===s?void 0:s.error({message:I}):a?null===s||void 0===s?void 0:s.error({message:k}):l?null===s||void 0===s?void 0:s.error({message:w}):void 0}))},className:n?"btn-danger":"btn-primary",children:[n?"Unpublish":"Publish"," product"]})}}}]);
//# sourceMappingURL=12.af9ab689.chunk.js.map