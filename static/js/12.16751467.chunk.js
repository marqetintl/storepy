(this["webpackJsonp@store/client"]=this["webpackJsonp@store/client"]||[]).push([[12],{337:function(e,t,c){"use strict";c.d(t,"c",(function(){return x})),c.d(t,"d",(function(){return v})),c.d(t,"b",(function(){return h})),c.d(t,"a",(function(){return g})),c.d(t,"e",(function(){return f}));var s=c(25),r=c(1),a=c(4),n=(c(2),c(8)),l=c(11),i=c(5),u=c(333),o=c(0),d=["onSuccess","onError"],b=["product","placeholder","form"],j=["children","form"],m=["product"],p=["image"],O=["product"],x=function(e){var t=e.onSuccess,c=e.onError,s=Object(a.a)(e,d),l=s.product,i=s.placeholder,j=void 0===i?"Give a name to the item":i,m=s.form,p=Object(a.a)(s,b);return m?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(n.b.Label,{value:"Name",className:"mb-1"}),Object(o.jsx)(n.b.TextInput,Object(r.a)(Object(r.a)({},p),{},{required:!0,name:"name",onSave:function(e){var s=e.value;if(s&&l&&l.slug)return u.a.patch(l.slug,{name:s},{name:l.name}).then((function(e){if(t)return t(e)})).catch((function(e){if(c)return c(e)}))},error:m.errors.name,placeholder:j,maxLength:99}))]}):null},v=function(e){var t=e.children,c=e.form,s=Object(a.a)(e,j);return c?Object(o.jsx)(n.b,Object(r.a)(Object(r.a)({},s),{},{context:c,children:t})):null};v.NameInput=x;var h=function(e){var t=e.product,c=Object(a.a)(e,m);return t&&t.slug?Object(o.jsx)(i.k,{multiple:!0,className:"btn-primary-3",onCreate:function(e){return e=e.filter((function(e){return e&&e.slug})),u.a.patch(t.slug,{images:[].concat(Object(s.a)(t.images),Object(s.a)(e.map((function(e){return e.slug}))))}).then((function(e){c.onCreateSuccess&&c.onCreateSuccess(e)})).catch((function(e){c.onCreateError&&c.onCreateError(e)}))}}):null},g=function(e){var t=e.image,c=Object(a.a)(e,p),s=Object(n.c)({alt_text:(null===t||void 0===t?void 0:t.alt_text)||""});return t&&t.slug?Object(o.jsx)(n.a,{value:s,className:c.className,children:Object(o.jsx)(l.h,{required:!0,image:t,onSuccess:c.onSuccess,onError:c.onError,placeholder:"Add an alternative text ..."})}):null},f=function(e){var t=e.product;Object(a.a)(e,O);return t?Object(o.jsx)("div",{className:"product-supplier-data",children:Object(o.jsxs)("ul",{children:[Object(o.jsxs)("li",{children:[Object(o.jsx)("span",{className:"",children:"Supplier"}),Object(o.jsx)("span",{className:"",children:t.supplier_name})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("span",{className:"",children:"Item id"}),Object(o.jsx)("span",{className:"",children:t.supplier_item_id})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("span",{className:"",children:"Category"}),Object(o.jsx)("span",{className:"",children:t.supplier_item_category})]}),Object(o.jsxs)("li",{children:[Object(o.jsx)("span",{className:"",children:"Item cost"}),Object(o.jsxs)("span",{className:"",children:[t.supplier_item_cost," (",t.supplier_item_cost_currency,")"]})]}),Object(o.jsx)("li",{children:Object(o.jsx)("a",{href:t.supplier_item_url,className:"text-underline",target:"_blank",rel:"noopener noreferrer",children:"View supplier page"})})]})}):null}},350:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return S})),c.d(t,"ProductPublishButton",(function(){return y}));var s=c(20),r=c(1),a=c(9),n=c(4),l=c(2),i=c(11),u=c(8),o=c(3),d=c(5),b=c(333),j=c(337),m=c(0),p=["instance","product"],O=["product"],x=function(e){return Object(m.jsx)(u.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Nom de l'attribut"},e),{},{required:!0,name:"name",maxLength:30,minLength:3}))},v=function(e){return Object(m.jsx)(u.b.TextInput,Object(r.a)(Object(r.a)({placeholder:"Valeur de l'attribut"},e),{},{required:!0,name:"value",maxLength:99,minLength:3}))},h=function(e){var t=e.instance,c=e.product,s=Object(n.a)(e,p),r=Object(u.c)({name:(null===t||void 0===t?void 0:t.name)||"",value:(null===t||void 0===t?void 0:t.value)||""});if(!t||!t.slug||!c||!c.slug)return null;return Object(m.jsx)(u.b,{context:r,onSubmit:function(e){return e.preventDefault(),b.a.patchAttribute(c.slug,t.slug,r.values).then((function(e){return null===s||void 0===s?void 0:s.onSuccess(e)})).catch((function(e){return r.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",style:{alignItems:"end"},children:[Object(m.jsx)("div",{className:"me-md-1",children:Object(m.jsx)(x,{error:r.errors.name})}),Object(m.jsx)("div",{className:"w-100 me-md-1",children:Object(m.jsx)(v,{error:r.errors.value})}),Object(m.jsxs)("div",{className:"d-flex ms-md-1",children:[Object(m.jsx)(d.c,{Icon:d.g.Trash,render:function(e){return Object(m.jsx)("div",{className:"p-3 w-100 d-flex justify-content-center",children:Object(m.jsxs)("div",{className:"w-md-50 d-flex align-items-center justify-content-between",children:[Object(m.jsx)("div",{children:Object(m.jsx)(d.b,{onClick:function(){return b.a.deleteAttribute(c.slug,t.slug).then((function(t){return null===e||void 0===e||e.setOpen(!1),null===s||void 0===s?void 0:s.onSuccess(t)})).catch((function(){var e;null===s||void 0===s||null===(e=s.toast)||void 0===e||e.error({message:"Could not delete attribute."})}))},className:"btn-danger",children:"Supprimer"})}),Object(m.jsx)("div",{children:Object(m.jsx)(d.b,{onClick:function(){return null===e||void 0===e?void 0:e.setOpen(!1)},children:"Annuler"})})]})})},renderHeader:function(e){return Object(m.jsx)("div",{className:"p-3",children:Object(m.jsxs)("div",{className:"fw-bold",children:["Supprimer l'attribut \"",t.name,'"']})})},className:"btn-danger-3 me-1"}),Object(m.jsx)(u.b.Submit,{value:"Save",className:"btn btn-primary-2"})]})]})})};function g(e){var t=e.product,c=Object(n.a)(e,O),s={name:"",value:""},r=Object(u.c)(s);if(!t||!t.slug)return null;return Object(m.jsx)(u.b,{context:r,onSubmit:function(e){return e.preventDefault(),b.a.postAttribute(t.slug,r.values).then((function(e){return r.setValues(s),null===c||void 0===c?void 0:c.onSuccess(e)})).catch((function(e){return r.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",style:{alignItems:"end"},children:[Object(m.jsxs)("div",{className:"me-md-1",children:[Object(m.jsx)(u.b.Label,{value:"Name"}),Object(m.jsx)(x,{error:r.errors.name})]}),Object(m.jsxs)("div",{className:"w-100 me-md-1",children:[Object(m.jsx)(u.b.Label,{value:"Value"}),Object(m.jsx)(v,{error:r.errors.value})]}),Object(m.jsx)("div",{className:"ms-md-1",children:Object(m.jsx)(d.d,{type:"submit",className:"btn-primary-3"})})]})})}var f=["tab"],_=function(e){var t=e.tab,c=Object(n.a)(e,f),o=c.prodSlug,p=c.product,O=c.setProduct,x=c.form,v=c.toast,_=Object(l.useState)(!1),N=Object(a.a)(_,2),S=N[0],C=N[1];switch(t){case"inventory":return Object(m.jsxs)("div",{className:"d-flex flex-column flex-md-row",children:[Object(m.jsxs)("div",{className:"flex-1",children:[Object(m.jsx)(i.g.Section,{title:"Sizes",text:"Add sizes"}),Object(m.jsxs)(i.g.Section,{title:"Attributes",actions:Object(m.jsx)(d.b,{onClick:function(){return C(!S)},className:"btn-primary-3",children:"Ajouter attribut"}),children:[S&&Object(m.jsxs)("div",{className:"border-bottom mb-2 pb-3",children:[Object(m.jsx)("p",{className:"text-center mb-3",children:"Ajouter un attribut au produit."}),Object(m.jsx)(g,{product:p,onSuccess:function(e){return O(Object(r.a)(Object(r.a)({},p),e))}})]}),Object(m.jsx)("div",{className:"my-3",children:p.attributes.map((function(e){return Object(m.jsx)("div",{className:"mb-1",children:Object(m.jsx)(h,{instance:e,product:p,onSuccess:function(e){return O(Object(r.a)(Object(r.a)({},p),e))}})},e.slug)}))})]})]}),Object(m.jsx)("div",{className:"w-md-35 ms-md-2",children:Object(m.jsx)(j.e,{product:p})})]});case"imgs":return Object(m.jsx)(i.g.Section,{title:"Images",text:"Add images to your product",actions:Object(m.jsx)(j.b,{product:p,onCreateSuccess:function(e){O(Object(r.a)(Object(r.a)({},p),e))}}),children:Object(m.jsx)("div",{className:"d-grid grid-md-3 grid-lg-4",style:{gap:4},children:p.images_data.map((function(e){return Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(d.h,Object(r.a)(Object(r.a)({},e),{},{className:"product-img"})),Object(m.jsxs)("div",{className:"d-flex",children:[Object(m.jsx)(j.a,{image:e}),Object(m.jsx)(d.i,{slug:e.slug,label:"",className:"btn-danger-3 ms-1",onSuccess:function(){O(Object(r.a)(Object(r.a)({},p),{},{images_data:p.images_data.filter((function(t){return t.slug!==e.slug})),images:p.images.filter((function(t){return t!==e.slug}))}))}})]})]},e.slug)}))})});case"seo":return Object(m.jsx)(u.b,{context:x,onSubmit:function(e){var t,c;e.preventDefault();var s={title:x.values.title,slug_public:x.values.slug_public};return b.a.patchPage(o,s,{title:null===p||void 0===p||null===(t=p.page)||void 0===t?void 0:t.title,slug_public:null===p||void 0===p||null===(c=p.page)||void 0===c?void 0:c.slug_public}).then((function(e){O(Object(r.a)(Object(r.a)({},p),e)),v.success({message:"Product page updated."})})).catch((function(e){x.handleError(e),v.error({message:"Could not update."})}))},children:Object(m.jsxs)(i.g.Section,{title:"Seo",children:[Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Meta title",className:"mb-1"}),Object(m.jsx)(u.b.TextInput,{required:!0,name:"title",error:x.errors.title,placeholder:"Give a name to the item",maxLength:99})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Slug",className:"mb-1"}),Object(m.jsx)(u.b.TextInput,{required:!0,name:"slug_public",error:x.errors.slug_public,placeholder:"Write slug ...",maxLength:99})]}),Object(m.jsx)("div",{className:"my-2",children:Object(m.jsx)(u.b.Submit,{value:"Update",className:"btn btn-primary-3"})})]})});default:return Object(m.jsxs)("div",{children:[Object(m.jsx)(i.g.Section,{title:"Description",children:Object(m.jsx)(j.d,{form:x,children:Object(m.jsx)(u.b.TextAreaX,{name:"description",onSave:function(e){var t=e.name,c=e.value;return b.a.patch(p.slug,Object(s.a)({},t,c),Object(s.a)({},t,p[t])).then((function(e){O(Object(r.a)(Object(r.a)({},p),e)),v.success({message:"Product updated."})})).catch((function(e){x.handleError(e),v.error({message:"Could not update item."})}))},error:x.errors.description,placeholder:"Give a description to the item"})})}),Object(m.jsx)("div",{className:"",children:Object(m.jsx)(y,{product:p,setProduct:O,toast:v})})]})}},N={name:"",description:"",title:"",category:"",slug_public:"",retail_price:0,is_pre_sale:!1,is_pre_sale_text:"",sale_price:0,is_on_sale:!1};function S(e){var t,c,s,n=e.match.params.prodSlug,p=Object(l.useState)(null),O=Object(a.a)(p,2),x=O[0],v=O[1],h=Object(l.useState)("info"),g=Object(a.a)(h,2),f=g[0],S=g[1],y=Object(l.useContext)(d.v),C=Object(u.c)(N),w=C.setValues;return Object(l.useEffect)((function(){b.a.detail(n).then((function(e){var t;v(e),w({name:e.name||"",description:e.description||"",category:e.category||"",retail_price:(null===e||void 0===e?void 0:e.retail_price)||0,is_pre_sale:e.is_pre_sale||!1,is_pre_sale_text:e.is_pre_sale_text||"",is_on_sale:e.is_on_sale||!1,sale_price:(null===e||void 0===e?void 0:e.sale_price)||0,title:e.page.title||"",slug_public:(null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.slug_public)||""})})).catch((function(e){!e.response||(console.log(e.response),e.response.status)}))}),[n,w]),x?(console.log(x),Object(m.jsxs)(i.g,{back:null===e||void 0===e?void 0:e.back,className:"product-update-view",children:[Object(m.jsx)(u.b,{context:C,onSubmit:function(e){e.preventDefault();var t={retail_price:C.values.retail_price,is_on_sale:C.values.is_on_sale};return C.values.category&&(t.category=C.values.category),C.values.is_on_sale&&(t.sale_price=C.values.sale_price),C.values.is_pre_sale&&(t.is_pre_sale=C.values.is_pre_sale,t.is_pre_sale_text=C.values.is_pre_sale_text),b.a.patch(x.slug,t).then((function(e){v(Object(r.a)(Object(r.a)({},x),e)),y.success({message:"Product updated."})})).catch((function(e){return y.error({message:"Could not update product."}),C.handleError(e)}))},children:Object(m.jsxs)("div",{className:"d-flex flex-column-reverse flex-md-row mb-2",children:[Object(m.jsx)("div",{className:"flex-1",children:Object(m.jsxs)(i.g.Section,{title:"Details",actions:Object(m.jsx)(i.i,{is_published:null===x||void 0===x||null===(t=x.page)||void 0===t?void 0:t.is_published,pill:!0}),children:[Object(m.jsx)("div",{className:"mb-1",children:Object(m.jsx)(j.d.NameInput,{product:x,form:C,onSuccess:function(e){v(Object(r.a)(Object(r.a)({},x),e)),y.success({message:"Item updated."})},onError:function(e){C.handleError(e),y.error({message:"Could not update item."})}})}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Category"}),Object(m.jsx)(u.b.SelectInput,{required:!0,name:"category",nullValue:{label:"Select category"},children:null===x||void 0===x||null===(c=x.categories)||void 0===c||null===(s=c.items)||void 0===s?void 0:s.map((function(e){return Object(l.createElement)(u.b.SelectInput.Option,Object(r.a)(Object(r.a)({},e),{},{key:e.value}))}))})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsx)(u.b.Label,{value:"Retail price",id:"retail_price_label"}),Object(m.jsx)(u.b.TextInput,{required:!0,type:"number",name:"retail_price",error:C.errors.retail_price,"aria-describedby":"retail_price_label",min:"0",step:"0.01"})]}),Object(m.jsxs)("div",{className:"mb-1",children:[Object(m.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[Object(m.jsx)(u.b.CheckboxInput,{name:"is_pre_sale",error:C.errors.is_pre_sale,className:"me-2"}),Object(m.jsx)(u.b.Label,{value:"Pre-sale"})]}),C.values.is_pre_sale&&Object(m.jsxs)("div",{className:"mb-2",children:[Object(m.jsx)(u.b.Label,{value:"Pre sale text",id:"is_pre_sale_text_label",className:"miq-checkbox-label"}),Object(m.jsx)(u.b.TextAreaX,{name:"is_pre_sale_text",error:C.errors.is_pre_sale_text,"aria-describedby":"is_pre_sale_text_label"})]})]}),Object(m.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[Object(m.jsx)(u.b.CheckboxInput,{name:"is_on_sale",error:C.errors.is_on_sale,className:"me-2"}),Object(m.jsx)(u.b.Label,{value:"On Sale"})]}),C.values.is_on_sale&&Object(m.jsxs)("div",{className:"mb-2",children:[Object(m.jsx)(u.b.Label,{value:"Sale price",id:"sale_price_label",className:"miq-checkbox-label"}),Object(m.jsx)(u.b.TextInput,{required:!0,type:"number",name:"sale_price",error:C.errors.sale_price,"aria-describedby":"sale_price_label",min:"0",step:"0.01"})]})]}),Object(m.jsx)("div",{className:"my-3",children:Object(m.jsx)(u.b.Submit,{value:"Update product",className:"btn btn-primary-3"})})]})}),Object(m.jsxs)("div",{className:" ms-md-2 mb-2 w-md-35 w-lg-25",children:[Object(m.jsx)(i.k,{slug:null===x||void 0===x?void 0:x.cover,data:x.cover_data,onCreate:function(e){b.a.patch(x.slug,{cover:e.slug}).then((function(e){v(Object(r.a)(Object(r.a)({},x),e)),y.success({message:"Product cover updated."})})).catch((function(e){y.error({message:"Could not upload cover image."})}))},onUpdate:function(e){return y.success({message:"Product cover updated."}),v(Object(r.a)(Object(r.a)({},x),{},{cover_data:e}))},onDelete:function(){return v(Object(r.a)(Object(r.a)({},x),{},{cover_data:null,cover:null}))},className:"mb-1"}),Object(m.jsx)(j.a,{image:null===x||void 0===x?void 0:x.cover_data})]})]})}),Object(m.jsxs)("div",{className:"my-2",children:[Object(m.jsx)("div",{className:"d-flex justify-content-center mb-3",children:Object(m.jsxs)("div",{className:"d-flex align-items-center",children:[Object(m.jsx)(d.b,{onClick:function(){return S("info")},className:Object(o.h)(["me-1","info"===f&&"btn-primary-3"]),children:"Info"}),Object(m.jsx)(d.b,{onClick:function(){return S("inventory")},className:Object(o.h)(["me-1","inventory"===f&&"btn-primary-3"]),children:"Inventory"}),Object(m.jsx)(d.b,{onClick:function(){return S("imgs")},className:Object(o.h)(["me-1","imgs"===f&&"btn-primary-3"]),children:"Images"}),Object(m.jsx)(d.b,{onClick:function(){return S("seo")},className:Object(o.h)(["seo"===f&&"btn-primary-3"]),children:"Settings"})]})}),Object(m.jsx)(_,{tab:f,prodSlug:n,product:x,setProduct:v,form:C,toast:y})]})]})):null}var y=function(e){var t=e.product,c=e.setProduct,s=e.toast;return Object(m.jsx)(d.b,{onClick:function(){b.a.publish(t.slug).then((function(e){null===c||void 0===c||c(Object(r.a)(Object(r.a)({},t),e))})).catch((function(e){var t=e.response,c=void 0===t?{}:t;if(!c.data)return null===s||void 0===s?void 0:s.error({message:"Something went awfully wrong!"});var r=c.data,a=r.retail_price,n=r.category,l=r.page;return a?null===s||void 0===s?void 0:s.error({message:"You can not publish a product without price"}):n?null===s||void 0===s?void 0:s.error({message:"You can not publish a product without category"}):l?null===s||void 0===s?void 0:s.error({message:"You can not publish a product without page"}):void 0}))},className:"btn-primary",children:"Publish product"})}}}]);
//# sourceMappingURL=12.16751467.chunk.js.map