"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[615],{3615:function(e,n,r){r.r(n),r.d(n,{default:function(){return x}});var t=r(8519),i=r(6520),s=r(2782),a=r(5603),c=r(2145),l=r(2134),o=r(2379),u=r(6574),d=r(1823),v=r(2898),m=r(324),f=r(8136),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:e.name||"",description:e.description||"",is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_slug:(null===e||void 0===e?void 0:e.meta_slug)||"",meta_description:(null===e||void 0===e?void 0:e.meta_description)||""}};function x(){var e=(0,i.UO)().catSlug,n=(0,a.cI)(p()),r=(0,l.QT)((function(){return(0,v.D)({slug:e}).retrieve()}),{refreshDeps:[e],onSuccess:function(e){var r=e.data;return n.setValues(p(r))},onError:function(e){e.response}}),t=r.res,o=r.updateData,d=new c.HM(t);if(!d.isSuccess)return null;var x=(0,v.D)(d.data),j=function(e){var n=e.data;return o(n)},b=n.errors;return(0,f.jsx)(s.ZP.View,{title:"Modifier cette cat\xe9gorie",back:"../",requiredPerms:["store.change_category"],className:"cat-staff-update-view",children:(0,f.jsxs)("div",{className:"d-grid grid-md-4",children:[(0,f.jsx)("div",{className:"p-md-1",children:(0,f.jsx)("div",{className:"p-1",children:(0,f.jsx)(h,{instance:x,updateData:o})})}),(0,f.jsxs)("div",{className:"span-md-3 span-lg-2",children:[(0,f.jsx)(s.ZP.Section,{title:"Details",children:(0,f.jsx)(m.V5,{context:n,instance:x,fields:["name","description"],onSuccess:j,children:(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(a.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})}),(0,f.jsx)(s.ZP.Section,{title:"SEO",children:(0,f.jsxs)(m.V5,{context:n,instance:x,fields:["meta_title","meta_description","meta_slug"],onSuccess:j,children:[(0,f.jsx)(a.lm,{error:b.meta_title}),(0,f.jsx)(a.uV,{error:b.meta_slug}),(0,f.jsx)(a.bA,{error:b.meta_description}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(a.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})})]}),(0,f.jsx)("div",{className:"span-lg-1",children:(0,f.jsx)("div",{style:{top:0,position:"sticky"},children:x.is_published?(0,f.jsx)(u.Ko,{instance:x,onSuccess:function(e){var n=e.data;return o(n)},children:"D\xe9publier cette cat\xe9gorie"}):(0,f.jsx)(u.H5,{instance:x,onSuccess:function(e){var n=e.data;return o(n)},onError:function(e){return n.handleError(e)},children:"Publier cette cat\xe9gorie"})})})]})})}var h=function(e){var n=e.updateData,r=e.instance,i=(0,a.cI)({view:"src"}),c=s.ZP.Img((null===r||void 0===r?void 0:r.cover_data)||{});if(null===c||void 0===c||!c.slug)return(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:(0,f.jsx)(s.CD,{onSuccess:function(e){var t=e.data;r.update({cover:t.slug}).then((function(e){var r=e.data;return n(r)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})});var l=(0,d.ex)(i.values.view);return(0,f.jsx)(a.ZP,{context:i,className:"p-cover-update-form",children:(0,f.jsx)(s.ZP.Section,{border:!0,title:(0,f.jsx)(s.RC,{onSuccess:function(){return n({cover_data:null,cover:null})},instance:c,className:"btn-danger-3",children:(0,f.jsx)(o.PJ.rF,{})}),actions:(0,f.jsx)(s.K7,{required:!0,name:"view"}),className:"p-image-card",children:(0,f.jsx)(s.Cz,{instance:c,field:i.values.view,onSuccess:function(e){var r=e.data;return n({cover:r.slug,cover_data:r})},children:(0,f.jsx)(l,(0,t.Z)({},c))})})})}},324:function(e,n,r){r.d(n,{CB:function(){return v},V5:function(){return m}});var t=r(8519),i=r(8312),s=r(5603),a=r(2145),c=(r(2411),r(2898)),l=r(8136),o=["instance","fields","children"],u=["onSuccess","onError","onWillSubmit"],d=["label","error"],v=function(e){var n=(0,s.cI)({name:""});return(0,l.jsxs)(f,{context:n,onSubmit:function(r){return r.preventDefault(),(0,c.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var t;n.handleError(r),null===e||void 0===e||null===(t=e.onError)||void 0===t||t.call(e,r)}))},children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(f.NameField,{error:n.errors.name})}),(0,l.jsx)("div",{className:"my-3",children:(0,l.jsx)(s.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},m=function(e){var n,r,s,c=e.instance,d=void 0===c?(0,a.q9)("Category instance"):c,v=e.fields,m=void 0===v?[]:v,p=e.children,x=(0,i.Z)(e,o),h=x.onSuccess,j=x.onError,b=x.onWillSubmit,g=(0,i.Z)(x,u),Z=g.context;return(0,l.jsxs)(f,(0,t.Z)((0,t.Z)({},g),{},{onSubmit:function(e){e.preventDefault(),null===b||void 0===b||b();var n={};return m.forEach((function(e){var r=Z.values[e];null!=r&&(n[e]=r)})),d.update(n).then((function(e){return null===h||void 0===h?void 0:h(e)})).catch((function(e){var n;return j?j(e):null===Z||void 0===Z||null===(n=Z.handleError)||void 0===n?void 0:n.call(Z,e)}))},children:[m.includes("name")&&(0,l.jsx)(f.NameField,{label:"Nom de la cat\xe9gorie",error:null===Z||void 0===Z||null===(n=Z.errors)||void 0===n?void 0:n.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),m.includes("description")&&(0,l.jsx)(f.DescriptionField,{label:"Description",error:null===Z||void 0===Z||null===(r=Z.errors)||void 0===r?void 0:r.description,text:"D\xe9crivez cet cat\xe9gorie."}),m.includes("position")&&(0,l.jsx)(f.PositionField,{label:"Position",error:null===Z||void 0===Z||null===(s=Z.errors)||void 0===s?void 0:s.position}),p]}))},f=function(e){return(0,l.jsx)(s.ZP,(0,t.Z)({},e))};f.NameField=function(e){return(0,l.jsx)(s.wd,(0,t.Z)((0,t.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},f.DescriptionField=function(e){return(0,l.jsx)(s.F$,(0,t.Z)({},e))},f.PositionField=function(e){var n=e.label,r=e.error,a=(0,i.Z)(e,d);return(0,l.jsx)(s.ZP.Field,{label:n,error:r,children:(0,l.jsx)(s.ZP.Text,(0,t.Z)({name:"position",type:"number",min:0},a))})}},2898:function(e,n,r){r.d(n,{D:function(){return u}});var t=r(8519),i=r(1135),s=r(7411),a=r(2518),c=r(2485),l=r(2782),o=function(e){(0,a.Z)(r,e);var n=(0,c.Z)(r);function r(){return(0,i.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"publish",value:function(){return this.update({is_published:!0})}},{key:"unpublish",value:function(){return this.update({is_published:!1})}}]),r}(l.x5),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,l.eR)((0,t.Z)((0,t.Z)({},e),{},{dt_published:n}),"categories",o)}}}]);
//# sourceMappingURL=615.e5267f9b.chunk.js.map